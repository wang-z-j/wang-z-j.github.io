<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Rust-L3 Rust 基础函数组成基础概念1234fn add(a: i32, b: i32) -&gt; i32 &#123;    &#x2F;&#x2F; return a + b;    a + b&#125;   声明函数关键字 fn  函数的位置可以随便放，rust不关心我们在哪里定义了函数   函数名  开头字符，后面是数字、下划线、字母 例如：add_2_two 开头下划线、后面是 数字、下划线、">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2025/01/05/Rust-L3%20Rust%20%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Rust-L3 Rust 基础函数组成基础概念1234fn add(a: i32, b: i32) -&gt; i32 &#123;    &#x2F;&#x2F; return a + b;    a + b&#125;   声明函数关键字 fn  函数的位置可以随便放，rust不关心我们在哪里定义了函数   函数名  开头字符，后面是数字、下划线、字母 例如：add_2_two 开头下划线、后面是 数字、下划线、">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-01-05T02:46:21.201Z">
<meta property="article:modified_time" content="2025-01-08T06:36:33.370Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/2025/01/05/Rust-L3 Rust 基础/"/>





  <title> | Hexo</title>
  








<meta name="generator" content="Hexo 7.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/05/Rust-L3%20Rust%20%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline"></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-01-05T10:46:21+08:00">
                2025-01-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Rust-L3-Rust-基础"><a href="#Rust-L3-Rust-基础" class="headerlink" title="Rust-L3 Rust 基础"></a>Rust-L3 Rust 基础</h2><h3 id="函数组成"><a href="#函数组成" class="headerlink" title="函数组成"></a>函数组成</h3><h4 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">add</span>(a: <span class="type">i32</span>, b: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">i32</span> &#123;</span><br><span class="line">    <span class="comment">// return a + b;</span></span><br><span class="line">    a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>声明函数关键字 fn</p>
<ul>
<li>函数的位置可以随便放，rust不关心我们在哪里定义了函数</li>
</ul>
</li>
<li><p>函数名</p>
<ul>
<li>开头字符，后面是数字、下划线、字母 例如：add_2_two</li>
<li>开头下划线、后面是 数字、下划线、字母,不能只有下划线 例如 _add2</li>
<li>函数名和变量名用蛇形命名法 例如：sum_fn_2</li>
</ul>
</li>
<li><p>参数及类型</p>
<ul>
<li>每一个参数都必须指定类型</li>
</ul>
</li>
<li><p>指定返回值类型 -&gt;</p>
<ul>
<li><p>语法： -&gt; i32</p>
</li>
<li><p>当函数体不写return的时候，可以省略分号</p>
</li>
<li><p>rust特殊返回类型</p>
<ul>
<li><p>如果一个函数无返回值，那么就返回()</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">print</span>(i: <span class="type">i32</span>) &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;no return&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">print</span>(i: <span class="type">i32</span>)<span class="punctuation">-&gt;</span> () &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;no return&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>函数永不返回</p>
</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 语法往往用做会导致程序崩溃的函数</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">never_return</span>() <span class="punctuation">-&gt;</span>! &#123;</span><br><span class="line">  <span class="built_in">panic!</span>(<span class="string">&quot;never_return&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 死循环 循环永不跳出，因此函数也永不返回：</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">never_return</span>() <span class="punctuation">-&gt;</span>! &#123;</span><br><span class="line">  <span class="keyword">loop</span> &#123;</span><br><span class="line">    <span class="comment">// todo</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>函数体</p>
</li>
</ul>
<h4 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h4><ul>
<li>不要修改下面两行代码!</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改前代码</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// 不要修改下面两行代码!</span></span><br><span class="line">    <span class="keyword">let</span> (x, y) = (<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s</span> = <span class="title function_ invoke__">sum</span>(x, y);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">assert_eq!</span>(s, <span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">sum</span>(x, y: <span class="type">i32</span>) &#123;</span><br><span class="line">    x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 修改后代码</span></span><br><span class="line"><span class="comment">// 1. 没写返回值类型</span></span><br><span class="line"><span class="comment">// 2. 不写return省略分号</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">sum</span>(x, y: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">i32</span> &#123;</span><br><span class="line">    x + y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用另一个类型来替代 i32</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 使用另一个类型来替代 i32</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">print</span>() <span class="punctuation">-&gt;</span> <span class="type">i32</span> &#123;</span><br><span class="line">   <span class="built_in">println!</span>(<span class="string">&quot;hello,world&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 修改后代码</span></span><br><span class="line"><span class="comment">// （）表示无返回值</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">print</span>() <span class="punctuation">-&gt;</span> () &#123;</span><br><span class="line">   <span class="built_in">println!</span>(<span class="string">&quot;hello,world&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>用两种方法求解 实现这个函数，不要修改函数签名!</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用两种方法求解</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">never_return</span>() <span class="punctuation">-&gt;</span> ! &#123;</span><br><span class="line">    <span class="comment">// 实现这个函数，不要修改函数签名!</span></span><br><span class="line">  	<span class="comment">// 方式 2</span></span><br><span class="line">    <span class="keyword">loop</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">  	<span class="comment">// 方式 1</span></span><br><span class="line">    <span class="comment">// panic!(&quot;never_return&quot;)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>填空</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// 填空</span></span><br><span class="line">    <span class="comment">// let b = __; // 修改前</span></span><br><span class="line">  	<span class="keyword">let</span> <span class="variable">b</span> = <span class="literal">false</span>; <span class="comment">// 修改后</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">_v</span> = <span class="keyword">match</span> b &#123;</span><br><span class="line">        <span class="literal">true</span> =&gt; <span class="number">1</span>,</span><br><span class="line">        <span class="comment">// 发散函数也可以用于 `match` 表达式，用于替代任何类型的值</span></span><br><span class="line">        <span class="literal">false</span> =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">            <span class="built_in">panic!</span>(<span class="string">&quot;we have no value for `false`, but we can panic&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Exercise Failed if printing out this line!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h3><h4 id="基础概念-1"><a href="#基础概念-1" class="headerlink" title="基础概念"></a>基础概念</h4><h5 id="条件控制"><a href="#条件控制" class="headerlink" title="条件控制"></a>条件控制</h5><ul>
<li>if表达式</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">number</span> = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> number &lt; <span class="number">5</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;condition was true&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;condition was false&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>if else</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">number</span> = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> number % <span class="number">4</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;number is divisible by 4&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> number % <span class="number">3</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;number is divisible by 3&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> number % <span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;number is divisible by 2&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;number is not divisible by 4, 3, or 2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>let 使用if else</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">condition</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">number</span> = <span class="keyword">if</span> condition &#123; </span><br><span class="line">   <span class="number">5</span> </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">   <span class="number">6</span> </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h5><ul>
<li><p>loop循环</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.break 退出循环</span></span><br><span class="line"><span class="comment">// 2. continue 跳过此次循环</span></span><br><span class="line"><span class="comment">// 3. &#x27;counting_up 相当于给循环命名，消除多个嵌套循环的歧义</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="symbol">&#x27;counting_up</span>: <span class="keyword">loop</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;count = &#123;count&#125;&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">remaining</span> = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">loop</span> &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;remaining = &#123;remaining&#125;&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> remaining ==<span class="number">9</span> &#123;</span><br><span class="line">              <span class="keyword">continue</span>;</span><br><span class="line">          	&#125;</span><br><span class="line">            <span class="keyword">if</span> remaining == <span class="number">5</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> count == <span class="number">2</span> &#123;</span><br><span class="line">                <span class="keyword">break</span> <span class="symbol">&#x27;counting_up</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            remaining -= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        count += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;End count = &#123;count&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>while循环</p>
</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">number</span> = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> number != <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;number&#125;!&quot;</span>);</span><br><span class="line"></span><br><span class="line">        number -= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;LIFTOFF!!!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>for循环</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="comment">// 1 普通for循环</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">a</span> = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">element</span> <span class="keyword">in</span> a &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;the value is: &#123;element&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">// 2 通过索引和值的方式迭代数组 `a` </span></span><br><span class="line">    <span class="keyword">for</span> (i,v) <span class="keyword">in</span> a.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;第&#123;&#125;个元素是&#123;&#125;&quot;</span>,i+<span class="number">1</span>,v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="所有权转移"><a href="#所有权转移" class="headerlink" title="所有权转移"></a>所有权转移</h5><ul>
<li><p>不可变借用  <code>for item in &amp;collection</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// String没有实现copy特性，因此发生了所有权转移</span></span><br><span class="line"><span class="comment">// 需要加&amp;符号，表示借用，不然会报错 borrow of moved value: `names`</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">names</span> = [<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;liming&quot;</span>),<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hanmeimei&quot;</span>)];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">name</span> <span class="keyword">in</span> &amp;names &#123;</span><br><span class="line">        <span class="comment">// do something with name...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
</li>
<li><p>可变借用  <code>for item in &amp;mut collection</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">arr</span> = <span class="built_in">vec!</span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">for</span> <span class="variable">item</span> <span class="keyword">in</span> &amp;<span class="keyword">mut</span> arr &#123;</span><br><span class="line">     <span class="keyword">if</span> *item == <span class="number">1</span> &#123;</span><br><span class="line">         *item = <span class="number">5</span>;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>转移所有权 <code>for item in collection</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对于实现了 `copy` 特征的数组(例如 [i32; 10] )而言， `for item in arr` 并不会把 `arr` 的所有权转移，而是直接对其进行了拷贝，因此循环之后仍然可以使用 `arr` </span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">arr</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">for</span> <span class="variable">item</span> <span class="keyword">in</span> arr &#123;</span><br><span class="line">   <span class="comment">// do something with name...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="练习题"><a href="#练习题" class="headerlink" title="练习题"></a>练习题</h4><ul>
<li><code>for in</code> 可以用于迭代一个迭代器，例如序列 <code>a..b</code>.</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改前</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">n</span> <span class="keyword">in</span> <span class="number">1</span>..=<span class="number">100</span> &#123; <span class="comment">// 修改此行，让代码工作</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">100</span> &#123;</span><br><span class="line">            <span class="built_in">panic!</span>(<span class="string">&quot;NEVER LET THIS RUN&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 修改后</span></span><br><span class="line"><span class="comment">// 1..100 左开右闭 加上 ‘=’ 左开右开</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">n</span> <span class="keyword">in</span> <span class="number">1</span>..<span class="number">100</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">100</span> &#123;</span><br><span class="line">            <span class="built_in">panic!</span>(<span class="string">&quot;NEVER LET THIS RUN&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>所有权转移问题（不可变借用）</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修复错误，不要新增或删除代码行</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">names</span> = [<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;liming&quot;</span>),<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hanmeimei&quot;</span>)];</span><br><span class="line">    <span class="comment">// for name in names &#123;</span></span><br><span class="line">        <span class="comment">// do something with name...</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">//  String没有实现copy特性，所有权发生了转移，使用不可变借用</span></span><br><span class="line">  	<span class="keyword">for</span> <span class="variable">name</span> <span class="keyword">in</span> &amp;names &#123;</span><br><span class="line">      <span class="comment">// todo</span></span><br><span class="line">  &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, names);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">numbers</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">    <span class="comment">// numbers中的元素实现了 Copy，因此无需转移所有权</span></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">n</span> <span class="keyword">in</span> numbers &#123;</span><br><span class="line">        <span class="comment">// do something with name...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, numbers);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>通过索引和值的方式迭代数组 <code>a</code></li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">a</span> = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>];</span><br><span class="line">    <span class="comment">// 通过索引和值的方式迭代数组 `a` </span></span><br><span class="line">    <span class="keyword">for</span> (i,v) <span class="keyword">in</span> a.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;第&#123;&#125;个元素是&#123;&#125;&quot;</span>,i+<span class="number">1</span>,v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>loop 是一个表达式，因此我们可以配合 <code>break</code> 来返回一个值</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">counter</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">result</span> = <span class="keyword">loop</span> &#123;</span><br><span class="line">        counter += <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> counter == <span class="number">10</span> &#123;</span><br><span class="line">           <span class="comment">// __; // 填空</span></span><br><span class="line">            <span class="keyword">break</span> counter * <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(result, <span class="number">20</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>当有多层循环时，你可以使用 <code>continue</code> 或 <code>break</code> 来控制外层的循环。要实现这一点，外部的循环必须拥有一个标签 <code>&#39;label</code>, 然后在 <code>break</code> 或 <code>continue</code> 时指定该标签</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 填空</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="symbol">&#x27;outer</span>: <span class="keyword">loop</span> &#123;</span><br><span class="line">        <span class="symbol">&#x27;inner1</span>: <span class="keyword">loop</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> count &gt;= <span class="number">20</span> &#123;</span><br><span class="line">                <span class="comment">// 这只会跳出 inner1 循环</span></span><br><span class="line">                <span class="keyword">break</span> <span class="symbol">&#x27;inner1</span>; <span class="comment">// 这里使用 `break` 也是一样的</span></span><br><span class="line">            &#125;</span><br><span class="line">            count += <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        count += <span class="number">5</span>;</span><br><span class="line">        <span class="symbol">&#x27;inner2</span>: <span class="keyword">loop</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> count &gt;= <span class="number">30</span> &#123;</span><br><span class="line">                <span class="keyword">break</span> <span class="symbol">&#x27;outer</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">continue</span> <span class="symbol">&#x27;outer</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// assert!(count == __)</span></span><br><span class="line">   <span class="built_in">assert!</span>(count == <span class="number">30</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="基础数据类型"><a href="#基础数据类型" class="headerlink" title="基础数据类型"></a>基础数据类型</h3><h4 id="类型概览"><a href="#类型概览" class="headerlink" title="类型概览"></a>类型概览</h4><table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
<th>值</th>
</tr>
</thead>
<tbody><tr>
<td><code>i8</code>、<code>i16</code>、<code>i32</code>、<code>i64</code>、<code>i128</code>、<code>u8</code>、<code>u16</code>、<code>u32</code>、<code>u64</code>、<code>u128</code></td>
<td>给定位宽的有符号整数和无符号整数</td>
<td><code>42</code>、<code>-5i8</code>、<code>0x400u16</code>、<code>0o100i16</code>、<code>20_922_789_888_000u64</code>、<code>b&#39;*&#39;</code>（<code>u8</code> 字节字面量）</td>
</tr>
<tr>
<td><code>isize</code>、<code>usize</code></td>
<td>与机器字（<code>32</code> 位或 <code>64</code> 位）一样大的有符号整数和无符号整数</td>
<td><code>137</code>、<code>-0b0101_0010isize</code>、<code>0xffff_fc00usize</code></td>
</tr>
<tr>
<td><code>f32</code>、<code>f64</code></td>
<td>单精度 IEEE 浮点数和双精度 IEEE 浮点数</td>
<td><code>1.61803</code>、<code>3.14f32</code>、<code>6.0221e23f64</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td>布尔值</td>
<td><code>true</code>、<code>false</code></td>
</tr>
<tr>
<td><code>char</code></td>
<td><code>Unicode</code> 字符，<code>32</code> 位宽（4 字节）</td>
<td><code>&#39;*&#39;</code>、<code>&#39;\n&#39;</code>、<code>&#39; 字 &#39;</code>、<code>&#39;\x7f&#39;</code>、<code>&#39;\u&#39;</code></td>
</tr>
<tr>
<td><code>(char, u8, i32)</code></td>
<td>元组，允许混合类型</td>
<td><code>(&#39;%&#39;, 0x7f, -1)</code></td>
</tr>
</tbody></table>
<h4 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h4><table>
<thead>
<tr>
<th>大小</th>
<th>有符号</th>
<th>无符号</th>
</tr>
</thead>
<tbody><tr>
<td>8 位</td>
<td>i8</td>
<td>u8</td>
</tr>
<tr>
<td>16 位</td>
<td>i16</td>
<td>u16</td>
</tr>
<tr>
<td>32 位</td>
<td>i32</td>
<td>u32</td>
</tr>
<tr>
<td>64 位</td>
<td>i64</td>
<td>u64</td>
</tr>
<tr>
<td>128 位</td>
<td>i128</td>
<td>u128</td>
</tr>
<tr>
<td>视架构而定</td>
<td>isize</td>
<td>usize</td>
</tr>
</tbody></table>
<h4 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h4><ul>
<li><p>精度问题</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">assert!</span>(<span class="number">0.1</span> + <span class="number">0.2</span> == <span class="number">0.3</span>); <span class="comment">// 断言失败 输出： assertion failed: 0.1 + 0.2 == 0.3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>NAN问题</p>
</li>
</ul>
  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对于数学上未定义的结果，如负数开平方根，Rust的浮点数类型会使用NaN（Not a Number）来处理这些情况。任何与NaN进行交互的操作都会返回NaN，并且NaN不能用于比较（如断言），这会导致程序崩溃。</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">v</span> = (-<span class="number">1.12_f64</span>).<span class="title function_ invoke__">sqrt</span>();</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;v is : &#123;v&#125;&quot;</span>) <span class="comment">// v is : NaN</span></span><br><span class="line"><span class="comment">// 通过is_nan() 方法判断</span></span><br><span class="line"><span class="keyword">if</span> v.<span class="title function_ invoke__">is_nan</span>() &#123;</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;v is nan&quot;</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="布尔类型"><a href="#布尔类型" class="headerlink" title="布尔类型"></a>布尔类型</h4><ul>
<li>true false</li>
<li>占用一个字节</li>
</ul>
<h4 id="字符"><a href="#字符" class="headerlink" title="字符"></a>字符</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 Rust 语言中这些都是字符，Rust 的字符不仅仅是 ASCII，所有的 Unicode 值都可以作为 Rust 字符，包括单个的中文、日文、韩文、emoji 表情符号等等，都是合法的字符类型。</span></span><br><span class="line">由于 Unicode 都是 <span class="number">4</span> 个字节编码，因此字符类型也是占用 <span class="number">4</span> 个字节</span><br><span class="line"><span class="keyword">let</span> <span class="variable">a</span>: <span class="type">char</span> = <span class="string">&#x27;中&#x27;</span>; <span class="comment">// 注意是单引号，双引号是字符串</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;占用字节数: &#123;&#125;&quot;</span>, std::mem::<span class="title function_ invoke__">size_of_val</span>(&amp;a)); <span class="comment">// 4</span></span><br></pre></td></tr></table></figure>

<h4 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h4><p>在Rust中，as关键字用于在原始类型（如i64、f64、u64、char等）之间进行类型转换。然而，需要注意的是，as关键字并不适用于复合类型，比如String或其他用户定义的类型。对于复合类型的转换，通常需要使用其他方法或函数。</p>
<h3 id="所有权"><a href="#所有权" class="headerlink" title="所有权"></a>所有权</h3><h4 id="所有权规则"><a href="#所有权规则" class="headerlink" title="所有权规则"></a>所有权规则</h4><ul>
<li>每个值都有一个所有者</li>
<li>在任意时刻，值只能有一个所有者</li>
<li>当所有者离开作用域，值会被丢弃</li>
</ul>
<h4 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a>变量的作用域</h4><p>变量在声明的地方引入作用域，并在离开作用域时释放资源</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="string">&quot;hello&quot;</span>; <span class="comment">// s 是有效的</span></span><br><span class="line"><span class="comment">// 使用 s</span></span><br><span class="line">&#125; <span class="comment">// 作用域结束，s 被丢弃</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">a</span>() &#123;</span><br><span class="line">	<span class="keyword">let</span> <span class="variable">s</span> = <span class="string">&quot;hello&quot;</span>; <span class="comment">// s 是有效的</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="所有权转移-1"><a href="#所有权转移-1" class="headerlink" title="所有权转移"></a>所有权转移</h4><p>当变量赋值给另一个变量时，所有权会发生转移</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">a</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">b</span> =a;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s2</span> = s1;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;s1: &#123;&#125;&quot;</span>, s1); <span class="comment">// borrow of moved value: `s1`</span></span><br><span class="line"><span class="comment">// 现在 s1 无效，所有权转移到了 s2</span></span><br><span class="line"><span class="comment">// 解决方式</span></span><br><span class="line"><span class="comment">// let s2 = s1.clone(); // 克隆一份</span></span><br><span class="line"><span class="comment">// let s2 = &amp;s1; // 借用</span></span><br></pre></td></tr></table></figure>

<h4 id="练习题-1"><a href="#练习题-1" class="headerlink" title="练习题"></a>练习题</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">fn</span> <span class="title function_">take_ownership</span>(s: <span class="type">String</span>) <span class="punctuation">-&gt;</span> <span class="type">String</span> &#123;</span><br><span class="line">        s</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s2</span> = <span class="title function_ invoke__">take_ownership</span>(s1);</span><br><span class="line">    <span class="comment">// 如下代码不能修改</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, s1);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, s2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式1  借用</span></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">take_ownership</span>(s: &amp;<span class="type">String</span>) <span class="punctuation">-&gt;</span> &amp;<span class="type">String</span> &#123;</span><br><span class="line">        s</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s2</span> = <span class="title function_ invoke__">take_ownership</span>(&amp;s1);</span><br><span class="line">    <span class="comment">// 如下代码不能修改</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, s1);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, s2);</span><br><span class="line"><span class="comment">// 方式2  clone</span></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">take_ownership</span>(s: <span class="type">String</span>) <span class="punctuation">-&gt;</span> <span class="type">String</span> &#123;</span><br><span class="line">        s</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s2</span> = <span class="title function_ invoke__">take_ownership</span>(s1.<span class="title function_ invoke__">clone</span>());</span><br><span class="line">    <span class="comment">// 如下代码不能修改</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, s1);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, s2);</span><br></pre></td></tr></table></figure>



<h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><h4 id="引用的规则"><a href="#引用的规则" class="headerlink" title="引用的规则"></a>引用的规则</h4><ul>
<li><p>同一时间内 一个变量只能有一个可变引用或者多个不可变引用</p>
<ul>
<li>示例一: 不可变引用与可变引用同时存在</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">y</span> = &amp;x; <span class="comment">// 不可变引用</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">z</span> = &amp;<span class="keyword">mut</span> x; <span class="comment">// 可变引用 cannot borrow `x` as mutable because it is also borrowed as immutable</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, y);</span><br></pre></td></tr></table></figure>

<ul>
<li>多个不可变引用</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">y</span> = &amp;x; <span class="comment">// 第一个不可变引用</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">z</span> = &amp;x; <span class="comment">// 第二个不可变引用</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;y: &#123;&#125;, z: &#123;&#125;&quot;</span>, y, z); <span class="comment">// 允许同时存在多个不可变引用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>多个可变引用是非法的</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">y</span> = &amp;<span class="keyword">mut</span> x; <span class="comment">// 第一个可变引用</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">z</span> = &amp;<span class="keyword">mut</span> x; <span class="comment">// 第二个可变引用，报错</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;y: &#123;&#125;, z: &#123;&#125;&quot;</span>, y, z); <span class="comment">// Error: Cannot borrow `x` as mutable more than once</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>引用必须总是有效的</p>
<ul>
<li>示例一 ： ：悬垂引用（无效引用）</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里我们尝试在一个块作用域内引用 x，然后将该引用 r 移到外部作用域。然而，由于 x 在块作用域结束时被销毁，r 成为了一个悬垂引用（指向已释放内存），Rust 编译器会报错</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">r</span>;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line">        r = &amp;x; <span class="comment">// 错误：x 在这一作用域结束后被销毁</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, r); <span class="comment">// Error: Use of possibly-dangling reference</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="move-borrowing-referencing"><a href="#move-borrowing-referencing" class="headerlink" title="move &amp; borrowing &amp; referencing"></a>move &amp; borrowing &amp; referencing</h4><ul>
<li>move 堆数据所有权转移</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 s1 拥有堆数据 String 的所有权，当 s1 被赋值给 s2 时，s2 获得了所有权，而 s1 不再有效。这是一个 所有权转移（move）的过程。</span></span><br><span class="line"><span class="comment">// 2 s1 不能再使用，因为它的所有权已被移动到 s2</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s2</span> = s1; <span class="comment">// println!(&quot;s1: &#123;&#125;&quot;, s1); // borrow of moved value: `s1` s1 的所有权已被移动，无法使用</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;s2: &#123;&#125;&quot;</span>, s2); <span class="comment">// 输出: Hello</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>borrowing 函数</p>
<p><strong>借用</strong>是指一个变量借用另一个变量的值。Rust 有两种借用方式：<strong>不可变借用</strong>和<strong>可变借用</strong>。借用不会转移所有权，借用者只能访问借用的数据，而不能修改其值，除非有可变借用。</p>
<p>允许变量借用另一个变量的值，通过借用可以访问数据，但不转移所有权。</p>
</li>
<li><p>referencing  引用变量</p>
</li>
</ul>
<p>​	引用是指给定一个变量的地址，不转移所有权，只是访问它的内容。引用包括不可变引用（<code>&amp;</code>）和可变引用（<code>&amp;mut</code>）。</p>
<h4 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h4><ul>
<li>字符串切片: 字符串切片是对字符串部分内容的引用</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s2</span> = &amp;s1[<span class="number">0</span>..<span class="number">5</span>];  <span class="comment">// 引用 &quot;hello&quot;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">s3</span> = &amp;s1[<span class="number">6</span>..<span class="number">11</span>]; <span class="comment">// 引用 &quot;world&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>数组切片： 数组切片与字符串切片类似</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">arr</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> <span class="variable">arr2</span> = &amp;arr[<span class="number">0</span>..<span class="number">2</span>] <span class="comment">// 引用[1,2]</span></span><br></pre></td></tr></table></figure>

<h4 id="课后习题"><a href="#课后习题" class="headerlink" title="课后习题"></a>课后习题</h4><ul>
<li>Rust 的借用检查器在编译时检查引用的生命周期，防止引用悬垂（即引用指向的内存已经被释放）。通过使用生命周期参数，Rust 能确保引用的有效性，并且避免在运行时出现访问无效内存的错误。</li>
<li><code>longest</code> 函数返回的是一个引用，但这个引用指向的是传入的参数 <code>x</code> 或 <code>y</code>，这两个参数的生命周期是有限的。Rust 需要知道返回的引用生命周期与函数参数之间的关系，才能保证引用在使用时是有效的</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">test_lifetime</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">large</span> = <span class="title function_ invoke__">longest</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;ab&quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;large one is &#123;large&#125;&quot;</span>);</span><br><span class="line">  	<span class="comment">// 定义 longest 函数，使用生命周期参数 &#x27;a</span></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">longest</span>&lt;<span class="symbol">&#x27;a</span>&gt;(x: &amp;<span class="symbol">&#x27;a</span> <span class="type">str</span>, y: &amp;<span class="symbol">&#x27;a</span> <span class="type">str</span>) <span class="punctuation">-&gt;</span> &amp;<span class="symbol">&#x27;a</span> <span class="type">str</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> x.<span class="title function_ invoke__">len</span>() &gt; y.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">            x</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            y</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="数组与切片"><a href="#数组与切片" class="headerlink" title="数组与切片"></a>数组与切片</h3><h4 id="声明和初始化数组"><a href="#声明和初始化数组" class="headerlink" title="声明和初始化数组"></a>声明和初始化数组</h4><ul>
<li>基本</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">arr</span>:[<span class="type">i32</span>:<span class="number">4</span>] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br></pre></td></tr></table></figure>

<ul>
<li>省略</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">arr</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br></pre></td></tr></table></figure>

<ul>
<li>指定默认初始值</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">arr</span> = [-<span class="number">1</span>,<span class="number">4</span>];</span><br></pre></td></tr></table></figure>

<ul>
<li>数组长度 len()</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">arr</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;arr len:&#123;&#125;&quot;</span>,arr.<span class="title function_ invoke__">len</span>());</span><br></pre></td></tr></table></figure>

<ul>
<li>for循环遍历</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">arr</span>:[<span class="type">i32</span>:<span class="number">4</span>] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">for</span> <span class="variable">index</span> <span class="keyword">in</span> <span class="number">0</span>..<span class="number">4</span> &#123;</span><br><span class="line">   <span class="built_in">println!</span>(<span class="string">&quot;index is: &#123;&#125; &amp; value is : &#123;&#125;&quot;</span>,index,arr[index]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> <span class="variable">item</span> <span class="keyword">in</span> arr.<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;item: &#123;&#125;&quot;</span>,itme);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>可变数组</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">arr</span>:[<span class="type">i32</span>:<span class="number">4</span>] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line">arr[<span class="number">0</span>] = <span class="number">11</span>; <span class="comment">// 报错 cannot mutate immutable variable `arr`</span></span><br><span class="line"><span class="comment">// 需要将数组变为可变数组</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">arr</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line">arr[<span class="number">0</span>] = <span class="number">11</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>引用传递: 函数对参数的任何修改都会影响到原来的数组</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">data</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="title function_ invoke__">update</span>(&amp;<span class="keyword">mut</span> data);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;Inside update &#123;:?&#125;&quot;</span>, data);</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">update</span>(arr: &amp;<span class="keyword">mut</span> [<span class="type">i32</span>; <span class="number">5</span>]) &#123;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">11</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Inside update &#123;:?&#125;&quot;</span>, arr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li><p>传值传递 ：函数对参数的任何修改都不会影响到原来的数组。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">data</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="title function_ invoke__">update</span>(data);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;Outside update &#123;:?&#125;&quot;</span>, data); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">update</span>(<span class="keyword">mut</span> arr: [<span class="type">i32</span>; <span class="number">5</span>]) &#123;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">11</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Inside update &#123;:?&#125;&quot;</span>, arr); <span class="comment">// [11, 2, 3, 4, 5]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="切片例子"><a href="#切片例子" class="headerlink" title="切片例子"></a>切片例子</h4><ul>
<li>取slice元素个数  len()</li>
<li>判断slice是否为空 is_empty()</li>
<li>判断是否包含某个元素 contains(&amp;x)</li>
<li>重复slice指定次数 repeat(count)</li>
<li>反转slice reverse()</li>
<li>将各元素压平(flatten)并通过指定的分隔符连接起来 join(&amp;x)|join(“xxx”)</li>
<li>交换两个索引处的元素，如s.swap(1,3)</li>
<li>以指定大小的窗口进行滚动迭代 windows</li>
<li>判断slice是否以某个slice开头 starts_with(&amp;[x,y,z])</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">arr</span> = [<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>];</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,   arr.<span class="title function_ invoke__">len</span>());  <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, arr.<span class="title function_ invoke__">repeat</span>(<span class="number">2</span>)); <span class="comment">// [11, 22, 33, 11, 22, 33]</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, arr.<span class="title function_ invoke__">contains</span>(&amp;<span class="number">22</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="comment">// reverse()</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">arr</span> = [<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>];</span><br><span class="line">arr.<span class="title function_ invoke__">reverse</span>();</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>,arr); <span class="comment">// [33,22,11]</span></span><br><span class="line"><span class="comment">// join()</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, [<span class="string">&quot;junma&quot;</span>,<span class="string">&quot;jinlong&quot;</span>].<span class="title function_ invoke__">join</span>(<span class="string">&quot; &quot;</span>)); <span class="comment">// junma jinlong</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, [[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]].<span class="title function_ invoke__">join</span>(&amp;<span class="number">0</span>)); <span class="comment">// [1,2,0,3,4]</span></span><br><span class="line"><span class="comment">// swap()</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">arr</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line">arr.<span class="title function_ invoke__">swap</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, arr); <span class="comment">// [1,3,2,4]</span></span><br><span class="line"><span class="comment">// starts_with()，相关的方法还有ens_with()</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">arr</span> = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>];</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, arr.<span class="title function_ invoke__">starts_with</span>(&amp;[<span class="number">10</span>]));  <span class="comment">// true</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, arr.<span class="title function_ invoke__">starts_with</span>(&amp;[<span class="number">10</span>, <span class="number">20</span>])); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, arr.<span class="title function_ invoke__">starts_with</span>(&amp;[<span class="number">30</span>]));  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<h4 id="练习题-2"><a href="#练习题-2" class="headerlink" title="练习题"></a>练习题</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">nums</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">    <span class="title function_ invoke__">product_except_self</span>(nums);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">product_except_self</span>(nums: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt;) <span class="punctuation">-&gt;</span> <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">n</span> = nums.<span class="title function_ invoke__">len</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">anwser</span> = <span class="built_in">vec!</span>[<span class="number">1</span>; n];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">1</span>..n &#123;</span><br><span class="line">        anwser[i] = anwser[i - <span class="number">1</span>] * nums[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">rigth</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> (<span class="number">0</span>..n).<span class="title function_ invoke__">rev</span>() &#123;</span><br><span class="line">        anwser[i] *= rigth;</span><br><span class="line">        rigth *= nums[i]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;anwser is : &#123;:?&#125;&quot;</span>, anwser);</span><br><span class="line">    anwser</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><h4 id="str"><a href="#str" class="headerlink" title="&amp;str"></a>&amp;str</h4><ul>
<li><p>这是一个字符串切片，固定大小并且不能够改变</p>
</li>
<li><p>&amp;str的转换</p>
<ul>
<li>字节数组<code>[u8]</code>|<code>Vec&lt;u8&gt;</code>-&gt;&amp;str</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::<span class="type">str</span>;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">b</span> = [<span class="number">104</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">32</span>, <span class="number">228</span>, <span class="number">184</span>, <span class="number">173</span>, <span class="number">229</span>, <span class="number">155</span>, <span class="number">189</span>];</span><br><span class="line">		<span class="keyword">let</span> <span class="variable">s</span> = <span class="type">str</span>::<span class="title function_ invoke__">from_utf8</span>(&amp;b).<span class="title function_ invoke__">unwarp</span>();</span><br><span class="line">  	<span class="built_in">println!</span>(<span class="string">&quot;s: &#123;&#125;&quot;</span>,s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>&amp;str -&gt; <code>[u8]</code>|<code>Vec&lt;u8&gt;</code></li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s</span> = <span class="string">&quot;hello 中国&quot;</span>;</span><br><span class="line">  	<span class="keyword">let</span> <span class="variable">b</span> = s.<span class="title function_ invoke__">as_bytes</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>String</code>-&gt;<code>&amp;str</code></p>
<p>Rust实现了自动解引用， 那么<code>&amp;String</code>在必要的时候 可以自动转换为<code>&amp;str</code>，因此在很多函数中，如果接收参数是字符串的引用，通常会采用<code>&amp;str</code>作为入参，以获取更好的数据兼容性</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello,world!&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">say_hello</span>(&amp;s);</span><br><span class="line">    <span class="title function_ invoke__">say_hello</span>(&amp;s[..]);</span><br><span class="line">    <span class="title function_ invoke__">say_hello</span>(s.<span class="title function_ invoke__">as_str</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">say_hello</span>(s: &amp;<span class="type">str</span>) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h4 id="String"><a href="#String" class="headerlink" title="String"></a>String</h4><ul>
<li><p>这是一个可增常、可改变、拥有所有权、UTF-8 编码的字符串类型。它通常用于需要改变或者增长字符串的情况。</p>
</li>
<li><p><strong>String</strong>的转化</p>
<ul>
<li>字节数组<code>Vec&lt;u8&gt;</code>-&gt;<code>String</code></li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">b</span> = <span class="built_in">vec!</span>[<span class="number">104</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">32</span>, <span class="number">228</span>, <span class="number">184</span>, <span class="number">173</span>, <span class="number">229</span>, <span class="number">155</span>, <span class="number">189</span>];</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from_utf8</span>(n).<span class="title function_ invoke__">unwarp</span>();</span><br></pre></td></tr></table></figure>

<ul>
<li>&amp;str -&gt; String （从一个&amp;str 获得一个 String却是低效的，因为要重新malloc数据）</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(s);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s2</span> = s.<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s3</span> = s.<span class="title function_ invoke__">to_owned</span>();</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="操作字符串"><a href="#操作字符串" class="headerlink" title="操作字符串"></a>操作字符串</h4><p>API地址：<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/string/struct.String.html#">https://doc.rust-lang.org/std/string/struct.String.html#</a></p>
<ul>
<li>追加push</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">s.<span class="title function_ invoke__">push_str</span>(<span class="string">&quot; world&quot;</span>); <span class="comment">// 追加字符串</span></span><br><span class="line">s.<span class="title function_ invoke__">push</span>(<span class="string">&#x27;!&#x27;</span>) <span class="comment">// 追加字符</span></span><br></pre></td></tr></table></figure>

<ul>
<li>insert</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">s.<span class="title function_ invoke__">inster_str</span>(<span class="number">0</span>,<span class="string">&quot;hh&quot;</span>);</span><br><span class="line">s.<span class="title function_ invoke__">inster</span>(<span class="number">0</span>,<span class="string">&#x27;h&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>替换 replace</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello rust rust&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s1</span> = s.<span class="title function_ invoke__">replace</span>(<span class="string">&quot;hello&quot;</span>,<span class="string">&quot;hi&quot;</span>); <span class="comment">// 返回新的</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">s2</span> = s.<span class="title function_ invoke__">replace</span>(<span class="string">&quot;rust&quot;</span>,<span class="string">&quot;RUST&quot;</span>,<span class="number">2</span>); <span class="comment">// 返回新的</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s3</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello rust rust&quot;</span>);</span><br><span class="line">s3.<span class="title function_ invoke__">replace_range</span>(<span class="number">0</span>..<span class="number">5</span>,<span class="string">&quot;hi&quot;</span>); <span class="comment">// 修改原来的字符，需要加mut</span></span><br></pre></td></tr></table></figure>

<ul>
<li>删除</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello rust rust&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">pop_result</span> = s.<span class="title function_ invoke__">pop</span>(); <span class="comment">// 删除最后一个字符 返回Option</span></span><br><span class="line"><span class="keyword">match</span> pop_result &#123;</span><br><span class="line">  <span class="title function_ invoke__">Some</span>(c) =&gt; <span class="built_in">println!</span>(c), <span class="comment">// 删除成功的元素</span></span><br><span class="line">  <span class="title function_ invoke__">None</span>() =&gt; <span class="built_in">println!</span>(<span class="string">&quot;none&quot;</span>) <span class="comment">// 表示删除失败</span></span><br><span class="line">&#125;</span><br><span class="line">s.<span class="title function_ invoke__">remove</span>(<span class="number">0</span>); <span class="comment">// 删除指定下标</span></span><br><span class="line">s.<span class="title function_ invoke__">truncate</span>(<span class="number">2</span>);<span class="comment">// 指定下标到结尾</span></span><br><span class="line">s.<span class="title function_ invoke__">clear</span>(); <span class="comment">// 清空</span></span><br></pre></td></tr></table></figure>

<ul>
<li>连接</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s1</span> = s + <span class="string">&quot; rust&quot;</span>;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;s:&#123;&#125;&quot;</span>, s); <span class="comment">// 会报错，因为s的所有权发生了改变，解决：s.clone()</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">string_rust</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;rust&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s2</span> = s.<span class="title function_ invoke__">add</span>(&amp;string_rust);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s3</span> = <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;&#123;&#125;!&quot;</span>,s,string_rust);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>字符串转义</p>
<ul>
<li>通过转义的方式 <code>\</code> 输出 ASCII 和 Unicode 字符。</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// 通过 \ + 字符的十六进制表示，转义输出一个字符</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">byte_escape</span> = <span class="string">&quot;I&#x27;m writing \x52\x75\x73\x74!&quot;</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;What are you doing\x3F (\\x3F means ?) &#123;&#125;&quot;</span>, byte_escape);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// \u 可以输出一个 unicode 字符</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">unicode_codepoint</span> = <span class="string">&quot;\u&#123;211D&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">character_name</span> = <span class="string">&quot;\&quot;DOUBLE-STRUCK CAPITAL R\&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(</span><br><span class="line">        <span class="string">&quot;Unicode character &#123;&#125; (U+211D) is called &#123;&#125;&quot;</span>,</span><br><span class="line">        unicode_codepoint, character_name</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 换行了也会保持之前的字符串格式</span></span><br><span class="line">    <span class="comment">// 使用\忽略换行符</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">long_string</span> = <span class="string">&quot;String literals</span></span><br><span class="line"><span class="string">                        can span multiple lines.</span></span><br><span class="line"><span class="string">                        The linebreak and indentation here -&gt;\</span></span><br><span class="line"><span class="string">                        &lt;- can be escaped too!&quot;</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, long_string);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>原样输出</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, <span class="string">&quot;hello \\x52\\x75\\x73\\x74&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">raw_str</span> = <span class="string">r&quot;Escapes don&#x27;t work here: \x3F \u&#123;211D&#125;&quot;</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, raw_str);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果字符串包含双引号，可以在开头和结尾加 #</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">quotes</span> = <span class="string">r#&quot;And then I said: &quot;There is no escape!&quot;&quot;#</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, quotes);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果还是有歧义，可以继续增加，没有限制</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">longer_delimiter</span> = <span class="string">r###&quot;A string with &quot;# in it. And even &quot;##!&quot;###</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, longer_delimiter);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Enum-枚举"><a href="#Enum-枚举" class="headerlink" title="Enum 枚举"></a>Enum 枚举</h3><h4 id="语法-规范"><a href="#语法-规范" class="headerlink" title="语法&amp;规范"></a>语法&amp;规范</h4><ul>
<li><p>语法</p>
<ul>
<li><p>filed-less enum</p>
</li>
<li><p>unit-only enum</p>
</li>
</ul>
</li>
<li><p>规范</p>
<ul>
<li>pascal case</li>
<li>snake_case</li>
</ul>
</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="meta">#[derive(Debug)]</span></span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Pets</span> &#123;</span><br><span class="line">        Cat,                           <span class="comment">// unit enum</span></span><br><span class="line">        <span class="title function_ invoke__">Fish</span>(<span class="type">String</span>),                  <span class="comment">// tuple</span></span><br><span class="line">        Dog &#123; name: <span class="type">String</span>, age: <span class="type">u8</span> &#125;, <span class="comment">// struct</span></span><br><span class="line">        Brid,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">print_pet</span>(name: &amp;Pets) <span class="punctuation">-&gt;</span> () &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Pet is &#123;:?&#125;&quot;</span>, name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">impl</span> <span class="title class_">Pets</span> &#123;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">log</span>(&amp;<span class="keyword">self</span>) &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;pet is &#123;:?&#125;&quot;</span>, <span class="keyword">self</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">impl</span> <span class="title class_">Pets</span> &#123;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">print</span>(kind: &amp;Pets) &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;kind is &#123;:?&#125;&quot;</span>, kind);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">cat</span> = Pets::Cat;</span><br><span class="line">    <span class="title function_ invoke__">print_pet</span>(&amp;cat);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">fish</span> = Pets::<span class="title function_ invoke__">Fish</span>(<span class="string">&quot;gold_fish&quot;</span>.<span class="title function_ invoke__">to_string</span>());</span><br><span class="line">    <span class="title function_ invoke__">print_pet</span>(&amp;fish);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">dog</span> = Pets::Dog &#123;</span><br><span class="line">        name: <span class="string">&quot;wangwang&quot;</span>.<span class="title function_ invoke__">to_string</span>(),</span><br><span class="line">        age: <span class="number">2</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    Pets::<span class="title function_ invoke__">print</span>(&amp;dog);</span><br><span class="line">    fish.<span class="title function_ invoke__">log</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Fieldless</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Tuple</span>(),</span><br><span class="line">        Struct &#123;&#125;,</span><br><span class="line">        Unit,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="number">0</span>, Fieldless::<span class="title function_ invoke__">Tuple</span>() <span class="keyword">as</span> <span class="type">usize</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">UnitOnlyEnum</span> &#123;</span><br><span class="line">        Foo = <span class="number">0</span>,</span><br><span class="line">        Bar = <span class="number">1</span>,</span><br><span class="line">        Baz = <span class="number">2</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="number">0</span>, UnitOnlyEnum::Foo <span class="keyword">as</span> <span class="type">usize</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">UnitOnlyEnum2</span> &#123;</span><br><span class="line">        Foo,</span><br><span class="line">        Bar,</span><br><span class="line">        Baz,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="number">0</span>, UnitOnlyEnum2::Foo <span class="keyword">as</span> <span class="type">usize</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Match"><a href="#Match" class="headerlink" title="Match"></a>Match</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Pets</span> &#123;</span><br><span class="line">        Cat,                           <span class="comment">// unit enum</span></span><br><span class="line">        <span class="title function_ invoke__">Fish</span>(<span class="type">String</span>),                  <span class="comment">// tuple</span></span><br><span class="line">        Dog &#123; name: <span class="type">String</span>, age: <span class="type">u8</span> &#125;, <span class="comment">// struct</span></span><br><span class="line">        Brid,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">pet</span> = Pets::Brid;</span><br><span class="line">    <span class="keyword">match</span> pet &#123;</span><br><span class="line">        Pets::Cat =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;Cat&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        Pets::<span class="title function_ invoke__">Fish</span>(s) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;Fish&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        _ =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;else pet&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  	<span class="comment">// if let 只需要关注当前声明的逻辑</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">cat</span> = Pets::Cat &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;let Cat&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">num</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">match</span> num &#123;</span><br><span class="line">        <span class="number">1</span> =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;num is 1&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="number">2</span> =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;num is 2&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        _ =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;else num&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Optons"><a href="#Optons" class="headerlink" title="Optons"></a>Optons</h4><ul>
<li>Some<T></li>
<li>None</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">num</span> = <span class="title function_ invoke__">Some</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">none</span>: <span class="type">Option</span>&lt;<span class="type">usize</span>&gt; = <span class="literal">None</span>;</span><br><span class="line">    <span class="keyword">match</span> num &#123;</span><br><span class="line">        <span class="title function_ invoke__">Some</span>(val) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;num is : &#123;&#125;&quot;</span>, val)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="literal">None</span> =&gt; &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">match</span> none &#123;</span><br><span class="line">        <span class="title function_ invoke__">Some</span>(_) =&gt; &#123;&#125;</span><br><span class="line">        <span class="literal">None</span> =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;none&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">map</span>: HashMap&lt;&amp;<span class="type">str</span>, <span class="type">usize</span>&gt; = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">a</span> = map.<span class="title function_ invoke__">get</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    <span class="keyword">match</span> a &#123;</span><br><span class="line">        <span class="title function_ invoke__">Some</span>(val) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, val)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="literal">None</span> =&gt; &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h4><ul>
<li>Ok<T></li>
<li>Err<E></li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">res</span> = <span class="title function_ invoke__">result_1</span>();</span><br><span class="line">    <span class="keyword">match</span> res &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(_) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;ok&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(_) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">result_1</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;(),()&gt; &#123;</span><br><span class="line">  <span class="comment">// Ok(())</span></span><br><span class="line">  <span class="title function_ invoke__">Err</span>(())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">file</span>: <span class="type">Result</span>&lt;File, std::io::Error&gt; = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;rust.txt&quot;</span>);</span><br><span class="line">    <span class="keyword">match</span> file &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(file) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;ok file&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(err) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;err file&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Options-Result相互转换"><a href="#Options-Result相互转换" class="headerlink" title="Options &amp; Result相互转换"></a>Options &amp; Result相互转换</h4><ul>
<li>Option -&gt; Result</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">op</span> = <span class="title function_ invoke__">Some</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">result</span> = op.<span class="title function_ invoke__">ok_or</span>(<span class="string">&quot;err&quot;</span>);</span><br><span class="line"><span class="built_in">assert_eq!</span>(<span class="title function_ invoke__">Ok</span>(<span class="number">1</span>),result);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">none</span>: <span class="type">Option</span>&lt;<span class="type">usize</span>&gt; = <span class="literal">None</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">reuslt_1</span> = none.<span class="title function_ invoke__">ok_or</span>(<span class="string">&quot;err&quot;</span>);</span><br><span class="line"><span class="built_in">assert_eq!</span>(<span class="title function_ invoke__">Err</span>(<span class="string">&quot;err&quot;</span>),reuslt_1);</span><br></pre></td></tr></table></figure>

<ul>
<li>Resut -&gt; Option</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">res</span>: <span class="type">Result</span>&lt;<span class="type">i32</span>, &amp;<span class="type">str</span>&gt; = <span class="title function_ invoke__">Ok</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">opt</span> = res.<span class="title function_ invoke__">ok</span>();</span><br><span class="line">    <span class="built_in">assert_eq!</span>(opt, <span class="title function_ invoke__">Some</span>(<span class="number">1</span>));</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Success&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">err</span>: <span class="type">Result</span>&lt;<span class="type">i32</span>, &amp;<span class="type">str</span>&gt; = <span class="title function_ invoke__">Err</span>(<span class="string">&quot;err&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">opt_1</span> = err.<span class="title function_ invoke__">ok</span>();</span><br><span class="line">    <span class="built_in">assert_eq!</span>(opt_1, <span class="literal">None</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Success&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>常用操作</p>
<ul>
<li>map：map<code>是一个方法，它可以在</code>Option<code>为</code>Some<code>时对其值应用一个转换函数，并返回一个新的</code>Option<code>。如果 </code>Option<code>是</code>None<code>，则不会应用该函数，直接返回 </code>None</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">some_number</span> = <span class="title function_ invoke__">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">result</span> = some_number.<span class="title function_ invoke__">map</span>(|x| x*<span class="number">2</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;result: &#123;&#125;&quot;</span>, result); <span class="comment">// 输出: Some(10)</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">no_number</span>:<span class="type">Option</span>&lt;<span class="type">i32</span>&gt; = <span class="literal">None</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">no_res</span> = no_number.<span class="title function_ invoke__">map</span>(|x| x*<span class="number">2</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;result: &#123;&#125;&quot;</span>, <span class="literal">None</span>); <span class="comment">// 输出: None</span></span><br></pre></td></tr></table></figure>

<ul>
<li>or_else：<code>or_else</code> 方法用于在 <code>Option</code> 为 <code>None</code> 时，执行一个闭包并返回一个新的 <code>Option</code>，如果原本是 <code>Some</code>，则不做任何改变。</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">some_number</span> = <span class="title function_ invoke__">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">result</span> = some_number.<span class="title function_ invoke__">or_else</span>(|x| <span class="title function_ invoke__">Some</span>(<span class="number">10</span>));</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;result: &#123;&#125;&quot;</span>, result); <span class="comment">// 输出: Some(5) 原本是Some，则不做任何改变。</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">no_number</span>:<span class="type">Option</span>&lt;<span class="type">i32</span>&gt; = <span class="literal">None</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">no_res</span> = no_number.<span class="title function_ invoke__">or_else</span>(|| <span class="title function_ invoke__">Some</span>(<span class="number">10</span>)) <span class="comment">//  // 输出: Some(10) `Option` 为 `None` 时，执行一个闭包并返回一个新的 `Option`</span></span><br></pre></td></tr></table></figure>

<ul>
<li>and_then：<code>and_then</code> 方法也类似于 <code>map</code>，但是它允许闭包返回一个 <code>Option</code> 类型。这意味着你可以链式调用多个 <code>Option</code> 操作，而每次都可以处理 <code>Some</code> 或 <code>None</code> 之后的值</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">some_number</span> = <span class="title function_ invoke__">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">result</span> = some_number.<span class="title function_ invoke__">and_then</span>(|x| <span class="keyword">if</span> x &gt; <span class="number">0</span> &#123;<span class="title function_ invoke__">Some</span>(x*<span class="number">2</span>)&#125; <span class="keyword">else</span> &#123;<span class="literal">None</span>&#125;);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, result); <span class="comment">// 输出: Some(10)</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">no_number</span>: <span class="type">Option</span>&lt;<span class="type">i32</span>&gt; = <span class="literal">None</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">result_none</span> = no_number.<span class="title function_ invoke__">and_then</span>(|x| <span class="title function_ invoke__">Some</span>(x * <span class="number">2</span>));</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, result_none); <span class="comment">// 输出: None</span></span><br></pre></td></tr></table></figure>

<h4 id="enum-mem"><a href="#enum-mem" class="headerlink" title="enum mem"></a>enum mem</h4><p>课程讲的比较模糊</p>
</li>
</ul>
<h3 id="struct结构体"><a href="#struct结构体" class="headerlink" title="struct结构体"></a>struct结构体</h3><h4 id="普通结构体"><a href="#普通结构体" class="headerlink" title="普通结构体"></a>普通结构体</h4><h5 id="定义结构体"><a href="#定义结构体" class="headerlink" title="定义结构体"></a>定义结构体</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  username: <span class="type">String</span>,</span><br><span class="line">  active: <span class="type">bool</span>,</span><br><span class="line">  email: <span class="type">String</span>,</span><br><span class="line">  sign_in_count: <span class="type">u64</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="创建结构体实例"><a href="#创建结构体实例" class="headerlink" title="创建结构体实例"></a>创建结构体实例</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、无序</span></span><br><span class="line"><span class="comment">// 2、每个字段都需要初始化</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">user_1</span> = User &#123;</span><br><span class="line">  username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;wzj&quot;</span>),</span><br><span class="line">  active: <span class="literal">true</span>,</span><br><span class="line">  email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;wzj@11.com&quot;</span>),</span><br><span class="line">  sign_in_count: <span class="number">1</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="使用字段初始化简化语法"><a href="#使用字段初始化简化语法" class="headerlink" title="使用字段初始化简化语法"></a>使用字段初始化简化语法</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">build_user</span>(email: <span class="type">String</span>, username: <span class="type">String</span>) <span class="punctuation">-&gt;</span> User &#123;</span><br><span class="line">    User &#123;</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">        username,</span><br><span class="line">        email,</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">email</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someone@example.com&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">username</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someusername123&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">user1</span> = User &#123;</span><br><span class="line">    email,</span><br><span class="line">    username,</span><br><span class="line">    active: <span class="literal">true</span>,</span><br><span class="line">    sign_in_count: <span class="number">1</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="从其他实例创建实例"><a href="#从其他实例创建实例" class="headerlink" title="从其他实例创建实例"></a>从其他实例创建实例</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">user2</span> = User &#123;</span><br><span class="line">    active: user1.active,</span><br><span class="line">    username: user1.username,</span><br><span class="line">    sign_in_count: user1.sign_in_count,</span><br><span class="line">    email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;another@example.com&quot;</span>),</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">user2</span> = User &#123;</span><br><span class="line">    email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;another@example.com&quot;</span>),</span><br><span class="line">    ..user1</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="访问结构体字段"><a href="#访问结构体字段" class="headerlink" title="访问结构体字段"></a>访问结构体字段</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">user1</span> = User &#123;</span><br><span class="line">    email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someone@example.com&quot;</span>),</span><br><span class="line">    username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someusername123&quot;</span>),</span><br><span class="line">    active: <span class="literal">true</span>,</span><br><span class="line">    sign_in_count: <span class="number">1</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, user1.email);</span><br></pre></td></tr></table></figure>

<h5 id="修改结构体字段（可变性）"><a href="#修改结构体字段（可变性）" class="headerlink" title="修改结构体字段（可变性）"></a>修改结构体字段（可变性）</h5><ul>
<li>整个实例必须是可变的</li>
<li>不允许只将某个字段标记为可变</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">user1</span> = User &#123;</span><br><span class="line">    email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someone@example.com&quot;</span>),</span><br><span class="line">    username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someusername123&quot;</span>),</span><br><span class="line">    active: <span class="literal">true</span>,</span><br><span class="line">    sign_in_count: <span class="number">1</span>,</span><br><span class="line">&#125;;</span><br><span class="line">user1.email = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;wzj@example.com&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="特殊结构体"><a href="#特殊结构体" class="headerlink" title="特殊结构体"></a>特殊结构体</h4><h5 id="元组结构体（Tuple-Struct）"><a href="#元组结构体（Tuple-Struct）" class="headerlink" title="元组结构体（Tuple Struct）"></a>元组结构体（Tuple Struct）</h5><p>结构体必须要有名称，但是结构体的字段可以没有名称，这种结构体长得很像元组，因此被称为元组结构体</p>
<p>元组结构体在你希望有一个整体名称，但是又不关心里面字段的名称时将非常有用。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Color</span>(<span class="type">i32</span>,<span class="type">i32</span>,<span class="type">i32</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">c_1</span> = <span class="title function_ invoke__">Color</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; &#123;&#125; &#123;&#125;&quot;</span>,c_1.<span class="number">0</span>,c_1.<span class="number">1</span>,c_1.<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<h5 id="单元结构体-（Unit-list-Struct）"><a href="#单元结构体-（Unit-list-Struct）" class="headerlink" title="单元结构体 （Unit-list Struct）"></a>单元结构体 （Unit-list Struct）</h5><p>如果你定义一个类型，但是不关心该类型的内容, 只关心它的行为时，就可以使用 <code>单元结构体</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">AlwaysEqual</span>;</span><br><span class="line"><span class="keyword">trait</span> <span class="title class_">SomeTrait</span> &#123;</span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">log</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span>&#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">SomeTrait</span> <span class="keyword">for</span> <span class="title class_">AlwaysEqual</span> &#123;</span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">log</span>(&amp;<span class="keyword">self</span>) &#123;</span><br><span class="line">    <span class="comment">// todo</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="所有权-1"><a href="#所有权-1" class="headerlink" title="所有权"></a>所有权</h4><h5 id="实现copy特性的类型的所有权转移"><a href="#实现copy特性的类型的所有权转移" class="headerlink" title="实现copy特性的类型的所有权转移"></a>实现copy特性的类型的所有权转移</h5><ul>
<li>实现了 Copy 特征的类型无需所有权转移，可以直接在赋值时进行数据拷贝</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">user1</span> = User &#123;</span><br><span class="line">        email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someone@example.com&quot;</span>),</span><br><span class="line">        username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someusername123&quot;</span>),</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">active</span> = user1.active;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, user1.active); <span class="comment">// 不会报错，因为实现了copy特性</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, user1.email);</span><br><span class="line">    <span class="title function_ invoke__">print_username</span>(user1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">print_username</span>(user: User) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, user.username);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="没有实现copy特性的所有权转移"><a href="#没有实现copy特性的所有权转移" class="headerlink" title="没有实现copy特性的所有权转移"></a>没有实现copy特性的所有权转移</h5><ul>
<li>字段所有权发生了改变，但是其他字段不受影响</li>
<li>结构体整体无法再被使用</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">user1</span> = User &#123;</span><br><span class="line">        email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someone@example.com&quot;</span>),</span><br><span class="line">        username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someusername123&quot;</span>),</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">name</span> = user1.username;</span><br><span class="line">	</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, user1.email);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, user1.username); <span class="comment">// 报错 所有权发生了改变</span></span><br><span class="line">    <span class="title function_ invoke__">print_username</span>(user1); <span class="comment">// 报错 所有权发生了改变  结构体整体无法再被使用</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">print_username</span>(user: User) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, user.username);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="结构体更新语法"><a href="#结构体更新语法" class="headerlink" title="结构体更新语法"></a>结构体更新语法</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">user1</span> = User &#123;</span><br><span class="line">        email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someone@example.com&quot;</span>),</span><br><span class="line">        username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someusername123&quot;</span>),</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">user2</span> = User &#123;</span><br><span class="line">        email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;another@example.com&quot;</span>),</span><br><span class="line">        ..user1</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// let user2 = User &#123;</span></span><br><span class="line">    <span class="comment">//     email: String::from(&quot;another@example.com&quot;),</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//     active: user1.active,</span></span><br><span class="line">    <span class="comment">//     username: user1.username,</span></span><br><span class="line">    <span class="comment">//     sign_in_count: user1.sign_in_count,</span></span><br><span class="line">    <span class="comment">// &#125;;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,user1.active);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,user1.username); <span class="comment">// 报错 所有权发生改变</span></span><br><span class="line">    <span class="title function_ invoke__">print_username</span>(user1); <span class="comment">// 报错 user1的字段所有权发生改变，整个实例无法使用</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">print_username</span>(user: User) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, user.username);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="结构体中的借用"><a href="#结构体中的借用" class="headerlink" title="结构体中的借用"></a>结构体中的借用</h5><p>可以让 <code>User</code> 结构体从其它对象借用数据，不过这么做，就需要引入生命周期(lifetimes)这个新概念，简而言之，生命周期能确保结构体的作用范围要比它所借用的数据的作用范围要小。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//struct User &#123;</span></span><br><span class="line"><span class="comment">//    username: &amp;str,</span></span><br><span class="line"><span class="comment">//    email: &amp;str,</span></span><br><span class="line"><span class="comment">//    sign_in_count: u64,</span></span><br><span class="line"><span class="comment">//    active: bool,</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">User</span>&lt;<span class="symbol">&#x27;a</span>&gt; &#123;</span><br><span class="line">        username: &amp;<span class="symbol">&#x27;a</span> <span class="type">str</span>,</span><br><span class="line">        email: &amp;<span class="symbol">&#x27;a</span> <span class="type">str</span>,</span><br><span class="line">        sign_in_count: <span class="type">u64</span>,</span><br><span class="line">        active: <span class="type">bool</span>,</span><br><span class="line">        data: [<span class="type">i32</span>; <span class="number">3</span>],</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">user1</span> = User &#123;</span><br><span class="line">        email: <span class="string">&quot;someone@example.com&quot;</span>,</span><br><span class="line">        username: <span class="string">&quot;someusername123&quot;</span>,</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><h5 id="定义方法"><a href="#定义方法" class="headerlink" title="定义方法"></a>定义方法</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    width: <span class="type">u32</span>,</span><br><span class="line">    height: <span class="type">u32</span>,</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">area</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">      &amp;<span class="keyword">self</span>.width * &amp;<span class="keyword">self</span>.height</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">rec</span> = Rectangle&#123;width:<span class="number">20</span>,height:<span class="number">30</span>&#125;;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">area</span> = rec.<span class="title function_ invoke__">area</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="self、-self-mut-self"><a href="#self、-self-mut-self" class="headerlink" title="self、&amp;self &amp;mut self"></a>self、&amp;self &amp;mut self</h5><ul>
<li><code>self</code> 表示 <code>Rectangle</code> 的所有权转移到该方法中，这种形式用的较少</li>
<li><code>&amp;self</code> 表示该方法对 <code>Rectangle</code> 的不可变借用</li>
<li><code>&amp;mut self</code> 表示可变借用</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">        width: <span class="type">u32</span>,</span><br><span class="line">        height: <span class="type">u32</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">        <span class="comment">// fn area(&amp;self) -&gt; u32 &#123;</span></span><br><span class="line">        <span class="comment">//     self.width * self.height</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="comment">// fn area(this: &amp;Self) -&gt; u32 &#123;</span></span><br><span class="line">        <span class="comment">//     this.width * this.height</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">area</span>(this: &amp;Rectangle) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">            this.width * this.height</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">rect1</span> = Rectangle &#123;</span><br><span class="line">        width: <span class="number">10</span>,</span><br><span class="line">        height: <span class="number">20</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  <span class="comment">// 当方法的参数为this：&amp;Self 或者this: &amp;Rectangle时，使用Rectangle::area的调用方式，（个人理解：js中调用静态方法）</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">area</span> = Rectangle::<span class="title function_ invoke__">area</span>(&amp;rect1);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;area is &#123;&#125;&quot;</span>, area);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="方法名跟结构体字段名相同"><a href="#方法名跟结构体字段名相同" class="headerlink" title="方法名跟结构体字段名相同"></a>方法名跟结构体字段名相同</h5><p>在 Rust 中，允许方法名跟结构体的字段名相同：</p>
<p>当我们使用 <code>rect1.width()</code> 时，Rust 知道我们调用的是它的方法，如果使用 <code>rect1.width</code>，则是访问它的字段</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">width</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">bool</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width &gt; <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">rect1</span> = Rectangle &#123;</span><br><span class="line">        width: <span class="number">30</span>,</span><br><span class="line">        height: <span class="number">50</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> rect1.<span class="title function_ invoke__">width</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;The rectangle has a nonzero width; it is &#123;&#125;&quot;</span>, rect1.width);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="getter-访问器"><a href="#getter-访问器" class="headerlink" title="getter 访问器"></a>getter 访问器</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    width: <span class="type">u32</span>,</span><br><span class="line">    height: <span class="type">u32</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">width</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">      <span class="keyword">self</span>.width</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">new</span>(width: <span class="type">u32</span>, height:<span class="type">u32</span>) <span class="punctuation">-&gt;</span> Rectangle &#123;</span><br><span class="line">      Rectangle&#123;width,height&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">rec</span> = Rectangle::<span class="title function_ invoke__">new</span>(<span class="number">30</span>,<span class="number">20</span>);</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">width</span> = rec.<span class="title function_ invoke__">width</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="关联函数"><a href="#关联函数" class="headerlink" title="关联函数"></a>关联函数</h5><ul>
<li>因为是函数，所以不能用 <code>.</code> 的方式来调用，我们需要用 <code>::</code> 来调用，例如 <code>let sq = Rectangle::new(3, 3);</code></li>
<li>Rust 中有一个约定俗成的规则，使用 <code>new</code> 来作为构造器的名称，出于设计上的考虑，Rust 特地没有用 <code>new</code> 作为关键字。</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">new</span>(w: <span class="type">u32</span>, h: <span class="type">u32</span>) <span class="punctuation">-&gt;</span> Rectangle &#123;</span><br><span class="line">        Rectangle &#123; width: w, height: h &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="多个impl定义"><a href="#多个impl定义" class="headerlink" title="多个impl定义"></a>多个impl定义</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">area</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width * <span class="keyword">self</span>.height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">can_hold</span>(&amp;<span class="keyword">self</span>, other: &amp;Rectangle) <span class="punctuation">-&gt;</span> <span class="type">bool</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width &gt; other.width &amp;&amp; <span class="keyword">self</span>.height &gt; other.height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="实现trail"><a href="#实现trail" class="headerlink" title="实现trail"></a>实现trail</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">trait</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">area</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">        width: <span class="type">u32</span>,</span><br><span class="line">        height: <span class="type">u32</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Circle</span> &#123;</span><br><span class="line">        radius: <span class="type">u32</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">impl</span> <span class="title class_">Shape</span> <span class="keyword">for</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">area</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.width * <span class="keyword">self</span>.height</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">impl</span> <span class="title class_">Shape</span> <span class="keyword">for</span> <span class="title class_">Circle</span> &#123;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">area</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.radius * <span class="number">3.14</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="作业-实现Debug特性"><a href="#作业-实现Debug特性" class="headerlink" title="作业 实现Debug特性"></a>作业 实现Debug特性</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fmt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    width: <span class="type">u32</span>,</span><br><span class="line">    height: <span class="type">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">new</span>(width: <span class="type">u32</span>, height: <span class="type">u32</span>) <span class="punctuation">-&gt;</span> Rectangle &#123;</span><br><span class="line">        Rectangle &#123; width, height &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">width</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">height</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 为 Rectangle 实现 Debug 特征</span></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">fmt</span>::<span class="built_in">Debug</span> <span class="keyword">for</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">fmt</span>(&amp;<span class="keyword">self</span>, f: &amp;<span class="keyword">mut</span> fmt::Formatter) <span class="punctuation">-&gt;</span> fmt::<span class="type">Result</span> &#123;</span><br><span class="line">        <span class="built_in">write!</span>(f, <span class="string">&quot;Rectangle &#123;&#123; width: &#123;&#125;, height: &#123;&#125; &#125;&#125;&quot;</span>, <span class="keyword">self</span>.width, <span class="keyword">self</span>.height)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">rect</span> = Rectangle::<span class="title function_ invoke__">new</span>(<span class="number">30</span>, <span class="number">50</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, rect); <span class="comment">// 使用 Debug 格式打印</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="匹配模式"><a href="#匹配模式" class="headerlink" title="匹配模式"></a>匹配模式</h3><h4 id="基础匹配模式"><a href="#基础匹配模式" class="headerlink" title="基础匹配模式"></a>基础匹配模式</h4><h5 id="match表达式"><a href="#match表达式" class="headerlink" title="match表达式"></a>match表达式</h5><ul>
<li>基本用法： match 语句可以用于模式匹配数字、字符串、枚举等。</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">num</span> = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">match</span> num &#123;</span><br><span class="line">  <span class="number">1</span>=&gt; <span class="built_in">println!</span>(<span class="string">&quot;one&quot;</span>),</span><br><span class="line">  <span class="number">2</span>=&gt; <span class="built_in">println!</span>(<span class="string">&quot;two&quot;</span>),</span><br><span class="line">  <span class="number">3</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Three!&quot;</span>),</span><br><span class="line">  _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Something else!&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="匹配模式的各种模式"><a href="#匹配模式的各种模式" class="headerlink" title="匹配模式的各种模式"></a>匹配模式的各种模式</h4><h5 id="字面值"><a href="#字面值" class="headerlink" title="字面值"></a>字面值</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">num</span> = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">match</span> num &#123;</span><br><span class="line">  <span class="number">1</span>=&gt; <span class="built_in">println!</span>(<span class="string">&quot;one&quot;</span>),</span><br><span class="line">  <span class="number">2</span>=&gt; <span class="built_in">println!</span>(<span class="string">&quot;two&quot;</span>),</span><br><span class="line">  <span class="number">3</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Three!&quot;</span>),</span><br><span class="line">  _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Something else!&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="变量模式"><a href="#变量模式" class="headerlink" title="变量模式"></a>变量模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 变量模式 将x的值绑定到y上</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">  y =&gt; <span class="built_in">println!</span>(<span class="string">&quot;y is &#123;&#125;&quot;</span>, y),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="通配符模式"><a href="#通配符模式" class="headerlink" title="通配符模式"></a>通配符模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">num</span> = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">match</span> num &#123;</span><br><span class="line">  <span class="number">1</span>=&gt; <span class="built_in">println!</span>(<span class="string">&quot;one&quot;</span>),</span><br><span class="line">  _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Something else!&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="元组模式"><a href="#元组模式" class="headerlink" title="元组模式"></a>元组模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">tup</span> = (<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">match</span> tup &#123;</span><br><span class="line">  (<span class="number">1</span>, y) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;First element is 1, second element is &#123;&#125;&quot;</span>, y),</span><br><span class="line">  (<span class="number">2</span>, y) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;First element is 2, second element is &#123;&#125;&quot;</span>, y),</span><br><span class="line">   _ =&gt; &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="结构体模式-结构体字段模式"><a href="#结构体模式-结构体字段模式" class="headerlink" title="结构体模式 + 结构体字段模式"></a>结构体模式 + 结构体字段模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">  x:<span class="type">i32</span>,</span><br><span class="line">  y:<span class="type">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">p1</span> = Point&#123;<span class="number">10</span>,<span class="number">20</span>&#125;;</span><br><span class="line"><span class="keyword">match</span> p1 &#123;</span><br><span class="line">  Point &#123; x: <span class="number">10</span>, y &#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;x is 10, y is &#123;&#125;&quot;</span>, y),</span><br><span class="line">  _ =&gt; &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 只绑定 x，其余字段忽略</span></span><br><span class="line"><span class="keyword">match</span> point &#123;</span><br><span class="line">   Point &#123; x: <span class="number">10</span>, .. &#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;x is &#123;&#125;&quot;</span>, x),</span><br><span class="line">   _ =&gt; &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="枚举模式"><a href="#枚举模式" class="headerlink" title="枚举模式"></a>枚举模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Direction</span> &#123;</span><br><span class="line">  Up,</span><br><span class="line">  Down,</span><br><span class="line">  Left,</span><br><span class="line">  Right,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">dir</span> = Direction::Up;</span><br><span class="line"><span class="keyword">match</span> dir &#123;</span><br><span class="line">   Direction::Up =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Going up&quot;</span>),</span><br><span class="line">   Direction::Down =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Going down&quot;</span>),</span><br><span class="line">    _ =&gt; &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="范围模式"><a href="#范围模式" class="headerlink" title="范围模式"></a>范围模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">  <span class="number">1</span>..=<span class="number">5</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;x is between 1 and 5 inclusive&quot;</span>),</span><br><span class="line">  <span class="number">6</span>..=<span class="number">10</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;x is between 6 and 10 inclusive&quot;</span>),</span><br><span class="line">  _ =&gt; &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="按值匹配模式"><a href="#按值匹配模式" class="headerlink" title="按值匹配模式"></a>按值匹配模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="title function_ invoke__">Some</span>(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">  <span class="title function_ invoke__">Some</span>(y) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Matched Some with value: &#123;&#125;&quot;</span>, y),</span><br><span class="line">  <span class="literal">None</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Matched None&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="带守卫模式"><a href="#带守卫模式" class="headerlink" title="带守卫模式"></a>带守卫模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">  n <span class="keyword">if</span> n &lt; <span class="number">10</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;n is less than 10&quot;</span>),</span><br><span class="line">  _ =&gt; &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="合并模式"><a href="#合并模式" class="headerlink" title="合并模式"></a>合并模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">  <span class="number">1</span>|<span class="number">2</span>|<span class="number">5</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Matched 1, 2, or 5&quot;</span>),</span><br><span class="line">  _ = &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="匹配模式各种应用场景"><a href="#匹配模式各种应用场景" class="headerlink" title="匹配模式各种应用场景"></a>匹配模式各种应用场景</h4><h5 id="处理错误"><a href="#处理错误" class="headerlink" title="处理错误"></a>处理错误</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">divide</span>(x: <span class="type">i32</span>, y: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">i32</span>, <span class="type">String</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">2</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">Err</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Cannot divide by zero&quot;</span>))</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">Ok</span>(x / y)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">divide</span>(<span class="number">0</span>, <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(result) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Result is &#123;&#125;&quot;</span>, result),</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(err) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Error: &#123;&#125;&quot;</span>, err),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="高级模式匹配技巧"><a href="#高级模式匹配技巧" class="headerlink" title="高级模式匹配技巧"></a>高级模式匹配技巧</h4><h5 id="嵌套模式"><a href="#嵌套模式" class="headerlink" title="嵌套模式"></a>嵌套模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">        Quit,</span><br><span class="line">        Move &#123; x: <span class="type">i32</span>, y: <span class="type">i32</span> &#125;,</span><br><span class="line">        <span class="title function_ invoke__">Write</span>(<span class="type">String</span>),</span><br><span class="line">        <span class="title function_ invoke__">ChangeColor</span>(<span class="type">i32</span>, <span class="type">i32</span>, <span class="type">i32</span>),</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">msg</span> = Message::<span class="title function_ invoke__">ChangeColor</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);</span><br><span class="line">    <span class="keyword">match</span> msg &#123;</span><br><span class="line">        Message::<span class="title function_ invoke__">ChangeColor</span>(r, g, b) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;Change the color to red &#123;&#125;, green &#123;&#125;, and blue &#123;&#125;&quot;</span>, r, g, b)</span><br><span class="line">        &#125;</span><br><span class="line">        _ =&gt; &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="匹配模式跟迭代器"><a href="#匹配模式跟迭代器" class="headerlink" title="匹配模式跟迭代器"></a>匹配模式跟迭代器</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">arr</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">num</span> <span class="keyword">in</span> arr.<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">        <span class="keyword">match</span> num &#123;</span><br><span class="line">            <span class="number">1</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Found 1&quot;</span>),</span><br><span class="line">            <span class="number">2</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Found 2&quot;</span>),</span><br><span class="line">            <span class="number">3</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Found 3&quot;</span>),</span><br><span class="line">            _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Found some other number: &#123;&#125;&quot;</span>, num),</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="if-let和while-let-简化单个匹配模式"><a href="#if-let和while-let-简化单个匹配模式" class="headerlink" title="if let和while let 简化单个匹配模式"></a>if let和while let 简化单个匹配模式</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">opt</span> = <span class="title function_ invoke__">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(x) = opt &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;Matched &#123;:?&#125;&quot;</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">iter</span> = <span class="built_in">vec!</span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>].<span class="title function_ invoke__">into_iter</span>();</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">let</span> <span class="variable">Some</span>(x) = iter.<span class="title function_ invoke__">next</span>() &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;Matched &#123;:?&#125;&quot;</span>, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="ref-和ref-mut"><a href="#ref-和ref-mut" class="headerlink" title="ref 和ref mut"></a>ref 和ref mut</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">str</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    <span class="comment">// match str &#123;</span></span><br><span class="line">    <span class="comment">//     x =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//         println!(&quot;str is: &#123;&#125;&quot;, x)</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//     _ =&gt; &#123;&#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// println!(&quot;str is: &#123;&#125;&quot;, str); // 报错 所有权发生改变 所有权给了x</span></span><br><span class="line">    <span class="keyword">match</span> <span class="type">str</span> &#123;</span><br><span class="line">        <span class="keyword">ref</span> x =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;str is: &#123;&#125;&quot;</span>, x)</span><br><span class="line">        &#125;</span><br><span class="line">        _ =&gt; &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 需要匹配后改变</span></span><br><span class="line">    <span class="keyword">match</span> <span class="type">str</span> &#123;</span><br><span class="line">        <span class="keyword">ref</span> <span class="keyword">mut</span> var =&gt; &#123;</span><br><span class="line">            *var = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        _ =&gt; &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;str is: &#123;&#125;&quot;</span>, <span class="type">str</span>); <span class="comment">// 报错 所有权发生改变</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="课后练习"><a href="#课后练习" class="headerlink" title="课后练习"></a>课后练习</h4><ul>
<li>步骤 1：添加 <code>serde</code> 和 <code>serde_json</code> 依赖</li>
</ul>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">serde</span> = &#123; version = <span class="string">&quot;1.0&quot;</span>, features = [<span class="string">&quot;derive&quot;</span>] &#125;</span><br><span class="line"><span class="attr">serde_json</span> = <span class="string">&quot;1.0&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>编写解析程序</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;()&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">json_str</span> = <span class="string">r#&quot;</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        &quot;name&quot;: &quot;Alice&quot;,</span></span><br><span class="line"><span class="string">        &quot;age&quot;: 30,</span></span><br><span class="line"><span class="string">        &quot;email&quot;: &quot;alice@example.com&quot;,</span></span><br><span class="line"><span class="string">        &quot;address&quot;: &#123;</span></span><br><span class="line"><span class="string">            &quot;street&quot;: &quot;123 Main St&quot;,</span></span><br><span class="line"><span class="string">            &quot;city&quot;: &quot;Wonderland&quot;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        &quot;phone_numbers&quot;: [&quot;123-456-7890&quot;, &quot;987-654-3210&quot;]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    &quot;#</span>;</span><br><span class="line">    <span class="comment">// 解析json </span></span><br><span class="line">  	<span class="comment">// ? 是 Rust 中的一种运算符，用于处理 Result 或 Option 类型。</span></span><br><span class="line">		<span class="comment">//它会检查表达式的结果，如果是 Ok(T) 或 Some(T)，则提取并返回值；如果是 Err(E) 或 None，则将错误或 			None 返回给调用者。</span></span><br><span class="line">		<span class="comment">//它简化了错误处理，避免了手动 match 的繁琐操作</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">v</span> = serde_json::<span class="title function_ invoke__">from_str</span>(&amp;json_str)?;</span><br><span class="line">    <span class="keyword">match</span> v &#123;</span><br><span class="line">        Value::<span class="title function_ invoke__">Object</span>(map) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(Value::<span class="title function_ invoke__">String</span>(name)) = map.<span class="title function_ invoke__">get</span>(<span class="string">&quot;name&quot;</span>) &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;name is &#123;&#125;&quot;</span>, name);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(Value::<span class="title function_ invoke__">Number</span>(age)) = map.<span class="title function_ invoke__">get</span>(<span class="string">&quot;age&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(age) = age.<span class="title function_ invoke__">as_f64</span>() &#123;</span><br><span class="line">                    <span class="built_in">println!</span>(<span class="string">&quot;age is &#123;&#125;&quot;</span>, age);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(Value::<span class="title function_ invoke__">String</span>(email)) = map.<span class="title function_ invoke__">get</span>(<span class="string">&quot;email&quot;</span>) &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;email is &#123;&#125;&quot;</span>, email);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(Value::<span class="title function_ invoke__">Object</span>(address)) = map.<span class="title function_ invoke__">get</span>(<span class="string">&quot;address&quot;</span>) &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;address&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(Value::<span class="title function_ invoke__">String</span>(street)) = address.<span class="title function_ invoke__">get</span>(<span class="string">&quot;street&quot;</span>) &#123;</span><br><span class="line">                    <span class="built_in">println!</span>(<span class="string">&quot;- street &#123;&#125;&quot;</span>, street);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(Value::<span class="title function_ invoke__">String</span>(city)) = address.<span class="title function_ invoke__">get</span>(<span class="string">&quot;city&quot;</span>) &#123;</span><br><span class="line">                    <span class="built_in">println!</span>(<span class="string">&quot;- city &#123;&#125;&quot;</span>, city);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(Value::<span class="title function_ invoke__">Array</span>(phone_numbers)) = map.<span class="title function_ invoke__">get</span>(<span class="string">&quot;phone_numbers&quot;</span>) &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;phone_numbers&quot;</span>);</span><br><span class="line">                <span class="keyword">for</span> <span class="variable">phone</span> <span class="keyword">in</span> phone_numbers &#123;</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Value</span>::<span class="title function_ invoke__">String</span>(phone_number) = phone &#123;</span><br><span class="line">                        <span class="built_in">println!</span>(<span class="string">&quot;- &#123;&#125;&quot;</span>, phone_number);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        _ =&gt; &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(())</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>代码解析</p>
<p><strong>解析 JSON 字符串</strong>：</p>
<ul>
<li>使用 <code>serde_json::from_str</code> 将 JSON 字符串解析为 <code>serde_json::Value</code> 类型。<code>Value</code> 类型可以代表不同类型的 JSON 数据，如对象、数组、数字、字符串等。</li>
</ul>
<p><strong>模式匹配</strong>：</p>
<ul>
<li>使用 <code>match</code> 语句来处理不同类型的 JSON 值。</li>
<li><code>Value::Object(map)</code> 将 JSON 对象（即 <code>&#123;&#125;</code>）转换为一个键值对集合（<code>map</code>）。</li>
</ul>
<p><strong>提取字段</strong>：</p>
<ul>
<li>对于每个键值对，使用 <code>map.get(&quot;key&quot;)</code> 提取值，然后根据值的类型（如 <code>String</code>、<code>Number</code>、<code>Object</code>、<code>Array</code> 等）进行匹配。</li>
<li>对于数字字段（如 <code>age</code>），使用 <code>as_i64()</code> 方法将 <code>Number</code> 类型转换为 <code>i64</code>，并进一步处理。</li>
</ul>
<p><strong>嵌套对象和数组</strong>：</p>
<ul>
<li>对嵌套的对象（如 <code>address</code>）和数组（如 <code>phone_numbers</code>）进行匹配，并递归地提取其中的字段或元素。</li>
</ul>
<p><strong>打印输出</strong>：</p>
<ul>
<li>将提取的字段打印出来，展示解析的结果。</li>
</ul>
</li>
</ul>
<h3 id="常见集合"><a href="#常见集合" class="headerlink" title="常见集合"></a>常见集合</h3><h4 id="Vec（Vector）"><a href="#Vec（Vector）" class="headerlink" title="Vec（Vector）"></a>Vec（Vector）</h4><h5 id="什么是Vec"><a href="#什么是Vec" class="headerlink" title="什么是Vec"></a>什么是Vec</h5><p><code>Vec</code> 是一个动态数组，可以根据需要动态增长和缩小。适用于需要按顺序存储数据的场景。</p>
<h5 id="Vec的基本操作"><a href="#Vec的基本操作" class="headerlink" title="Vec的基本操作"></a>Vec的基本操作</h5><h6 id="创建-初始化"><a href="#创建-初始化" class="headerlink" title="创建&#x2F;初始化"></a>创建&#x2F;初始化</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">v2</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span>: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>();</span><br></pre></td></tr></table></figure>

<h6 id="添加元素"><a href="#添加元素" class="headerlink" title="添加元素"></a>添加元素</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span>: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>(); <span class="comment">// v 必须是可变的</span></span><br><span class="line">v.<span class="title function_ invoke__">push</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h6 id="访问元素"><a href="#访问元素" class="headerlink" title="访问元素"></a>访问元素</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">vec_1</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">result</span> = v.<span class="title function_ invoke__">get</span>(<span class="number">1</span>); <span class="comment">// 返回的是option</span></span><br><span class="line">    <span class="comment">// 方式1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(x) = result &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;第一个元素是：&#123;&#125;&quot;</span>, x)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 方式2</span></span><br><span class="line">    <span class="keyword">match</span> result &#123;</span><br><span class="line">        <span class="title function_ invoke__">Some</span>(x) =&gt; &#123;</span><br><span class="line">          <span class="built_in">println!</span>(<span class="string">&quot;第一个元素是：&#123;&#125;&quot;</span>, x)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="literal">None</span> =&gt; &#123;&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="修改元素"><a href="#修改元素" class="headerlink" title="修改元素"></a>修改元素</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">v[<span class="number">0</span>] = <span class="number">11</span>;</span><br></pre></td></tr></table></figure>

<h6 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="comment">//`&amp;v` 获取的是 Vec 的引用，不会消耗 Vec 本身。</span></span><br><span class="line"><span class="keyword">for</span> <span class="variable">vv</span> <span class="keyword">in</span> &amp;v &#123;</span><br><span class="line">  <span class="title function_ invoke__">println</span>(<span class="string">&quot;vv&quot;</span>, vv);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Vec进阶用法"><a href="#Vec进阶用法" class="headerlink" title="Vec进阶用法"></a>Vec进阶用法</h5><h6 id="使用枚举存储多种类型"><a href="#使用枚举存储多种类型" class="headerlink" title="使用枚举存储多种类型"></a>使用枚举存储多种类型</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="meta">#[derive(Debug)]</span></span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">SpreadsheetCell</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Int</span>(<span class="type">i32</span>),</span><br><span class="line">        <span class="title function_ invoke__">Float</span>(<span class="type">f64</span>),</span><br><span class="line">        <span class="title function_ invoke__">Text</span>(<span class="type">String</span>),</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span> = <span class="built_in">vec!</span>[</span><br><span class="line">        SpreadsheetCell::<span class="title function_ invoke__">Int</span>(<span class="number">3</span>),</span><br><span class="line">        SpreadsheetCell::<span class="title function_ invoke__">Float</span>(<span class="number">0.032</span>),</span><br><span class="line">        SpreadsheetCell::<span class="title function_ invoke__">Text</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello&quot;</span>)),</span><br><span class="line">    ];</span><br><span class="line">    v.<span class="title function_ invoke__">push</span>(SpreadsheetCell::<span class="title function_ invoke__">Int</span>(<span class="number">4</span>));</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(SpreadsheetCell::<span class="title function_ invoke__">Int</span>(x)) = v.<span class="title function_ invoke__">get</span>(<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, x)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, v)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="容量与重新分配"><a href="#容量与重新分配" class="headerlink" title="容量与重新分配"></a>容量与重新分配</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// `Vec::with_capacity` 可以预先为 Vec 分配容量，减少内存重新分配的次数。</span></span><br><span class="line"><span class="comment">// `capacity` 方法可以查看当前 Vec 的容量。</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">_vec_3</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span>: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; = <span class="type">Vec</span>::<span class="title function_ invoke__">with_capacity</span>(<span class="number">2</span>);</span><br><span class="line">    v.<span class="title function_ invoke__">push</span>(<span class="number">2</span>);</span><br><span class="line">    v.<span class="title function_ invoke__">push</span>(<span class="number">2</span>);</span><br><span class="line">    v.<span class="title function_ invoke__">push</span>(<span class="number">2</span>);</span><br><span class="line">    v.<span class="title function_ invoke__">push</span>(<span class="number">2</span>);</span><br><span class="line">    v.<span class="title function_ invoke__">push</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, v);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, v.<span class="title function_ invoke__">capacity</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Vec常见的陷阱"><a href="#Vec常见的陷阱" class="headerlink" title="Vec常见的陷阱"></a>Vec常见的陷阱</h5><h6 id="索引越界"><a href="#索引越界" class="headerlink" title="索引越界"></a>索引越界</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"> <span class="comment">// let does_not_exist = &amp;v[100]; // 这将会引发 panic</span></span><br><span class="line"><span class="comment">// 使用get跟安全 如果发生越界，会走进none</span></span><br><span class="line"><span class="keyword">match</span> v.<span class="title function_ invoke__">get</span>(<span class="number">0</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">Some</span>(x) =&gt; &#123;&#125;</span><br><span class="line">  <span class="literal">None</span> =&gt; &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="可变引用与不可变引用的混用"><a href="#可变引用与不可变引用的混用" class="headerlink" title="可变引用与不可变引用的混用"></a>可变引用与不可变引用的混用</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// _vec_3();</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">first</span> = &amp;v[<span class="number">0</span>]; <span class="comment">//  ----- immutable borrow later used here</span></span><br><span class="line">    v.<span class="title function_ invoke__">push</span>(<span class="number">4</span>); <span class="comment">// 这将引发编译错误，因为我们已经有一个不可变引用</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, first)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h4><h5 id="HashMap基本操作"><a href="#HashMap基本操作" class="headerlink" title="HashMap基本操作"></a>HashMap基本操作</h5><h6 id="创建和初始化"><a href="#创建和初始化" class="headerlink" title="创建和初始化"></a>创建和初始化</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">scores</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">scores.<span class="title function_ invoke__">inster</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Blue&quot;</span>),<span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<h6 id="访问元素-1"><a href="#访问元素-1" class="headerlink" title="访问元素"></a>访问元素</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">scores</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Blue&quot;</span>), <span class="number">10</span>);</span><br><span class="line">    scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Yellow&quot;</span>), <span class="number">50</span>);</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(val) = scores.<span class="title function_ invoke__">get</span>(<span class="string">&quot;Blue&quot;</span>) &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, val)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="遍历元素"><a href="#遍历元素" class="headerlink" title="遍历元素"></a>遍历元素</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">scores</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Blue&quot;</span>), <span class="number">10</span>);</span><br><span class="line">scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Yellow&quot;</span>), <span class="number">50</span>);</span><br><span class="line"><span class="keyword">for</span>(key,value) <span class="keyword">in</span> &amp;scores &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>, key, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="HashMap-进阶用法"><a href="#HashMap-进阶用法" class="headerlink" title="HashMap 进阶用法"></a>HashMap 进阶用法</h5><h6 id="更新哈希表"><a href="#更新哈希表" class="headerlink" title="更新哈希表"></a>更新哈希表</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">map</span>&lt;<span class="type">String</span>,<span class="type">i32</span>&gt; = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">map.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Blue&quot;</span>),<span class="number">50</span>);</span><br><span class="line">map.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Blue&quot;</span>),<span class="number">10</span>); <span class="comment">// 存在时更新</span></span><br><span class="line"><span class="comment">// 返回值是插入的</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">res</span> = map.<span class="title function_ invoke__">entry</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Red&quot;</span>).<span class="title function_ invoke__">or_insert</span>(<span class="number">10</span>); <span class="comment">// 不存在插入</span></span><br><span class="line">*res += <span class="number">10</span>;</span><br><span class="line">map.<span class="title function_ invoke__">entry</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Red&quot;</span>).<span class="title function_ invoke__">or_insert</span>(<span class="number">20</span>); <span class="comment">// 存在不做操作</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;red: &#123;&#125;&quot;</span>, red); <span class="comment">// red: 60</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, scores)； <span class="comment">// &#123;&quot;Red&quot;: 60, &quot;Blue&quot;: 20&#125;</span></span><br></pre></td></tr></table></figure>



<h6 id="合并哈希表"><a href="#合并哈希表" class="headerlink" title="合并哈希表"></a>合并哈希表</h6><ul>
<li>合并两个 <code>HashMap</code> 时，使用 <code>entry</code> 方法避免覆盖已有的键值对</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">map1</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">map1.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>);</span><br><span class="line">map1.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;b&quot;</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">map2</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">map2.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;b&quot;</span>, <span class="number">3</span>);</span><br><span class="line">map2.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;c&quot;</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (k,v) <span class="keyword">in</span> map1 &#123;</span><br><span class="line">  map2.<span class="title function_ invoke__">entry</span>(k).<span class="title function_ invoke__">or_insert</span>(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="HashMap-常见陷阱"><a href="#HashMap-常见陷阱" class="headerlink" title="HashMap 常见陷阱"></a>HashMap 常见陷阱</h5><h6 id="哈希冲突"><a href="#哈希冲突" class="headerlink" title="哈希冲突"></a>哈希冲突</h6><ul>
<li>不同的健（key）有相同的Hash值，内部已经解决</li>
</ul>
<h6 id="值的所有权问题"><a href="#值的所有权问题" class="headerlink" title="值的所有权问题"></a>值的所有权问题</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">field_name</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Favorite color&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">field_value</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Blue&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">map</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    map.<span class="title function_ invoke__">insert</span>(field_name, field_value);</span><br><span class="line">    <span class="comment">// map.insert(field_name.clone(), field_value.clone());</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, field_name); <span class="comment">// 报错，所有权已经交给了map</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, field_value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="练习-1"><a href="#练习-1" class="headerlink" title="练习"></a>练习</h4><h5 id="使用vec实现简单的栈"><a href="#使用vec实现简单的栈" class="headerlink" title="使用vec实现简单的栈"></a>使用vec实现简单的栈</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Stack</span>&lt;T&gt; &#123;</span><br><span class="line">        elements: <span class="type">Vec</span>&lt;T&gt;,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">impl</span>&lt;T&gt; Stack&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">new</span>() <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">            Stack &#123;</span><br><span class="line">                elements: <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>(),</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/// 将元素压入栈</span></span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">push</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, element: T) &#123;</span><br><span class="line">            <span class="keyword">self</span>.elements.<span class="title function_ invoke__">push</span>(element);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 弹出栈顶元素</span></span><br><span class="line">        <span class="comment">/// 如果栈为空，则返回 `None`</span></span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">pop</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;T&gt; &#123;</span><br><span class="line">            <span class="keyword">self</span>.elements.<span class="title function_ invoke__">pop</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/// 查看栈顶元素（但不移除）</span></span><br><span class="line">        <span class="comment">/// 如果栈为空，则返回 `None`</span></span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">peek</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;&amp;T&gt; &#123;</span><br><span class="line">            <span class="keyword">self</span>.elements.<span class="title function_ invoke__">last</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">stack</span>: Stack&lt;<span class="type">i32</span>&gt; = Stack::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    stack.<span class="title function_ invoke__">push</span>(<span class="number">10</span>);</span><br><span class="line">    stack.<span class="title function_ invoke__">push</span>(<span class="number">20</span>);</span><br><span class="line">    stack.<span class="title function_ invoke__">push</span>(<span class="number">30</span>);</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(val) = stack.<span class="title function_ invoke__">pop</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;pop: &#123;&#125;&quot;</span>, val) <span class="comment">// 30</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(value) = stack.<span class="title function_ invoke__">peek</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;peek: &#123;&#125;&quot;</span>, value) <span class="comment">// 20</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="用-HashMap-实现一个字频统计器"><a href="#用-HashMap-实现一个字频统计器" class="headerlink" title="用 HashMap 实现一个字频统计器"></a>用 <code>HashMap</code> 实现一个字频统计器</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">text</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello world! Hello Rust. Rust is amazing. Hello Rust world!&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">new_text</span>: <span class="type">String</span> = text.<span class="title function_ invoke__">chars</span>().<span class="title function_ invoke__">filter</span>(|c| !c.<span class="title function_ invoke__">is_whitespace</span>()).<span class="title function_ invoke__">collect</span>(); <span class="comment">// 去掉空格</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">map</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">c</span> <span class="keyword">in</span> new_text.<span class="title function_ invoke__">chars</span>() &#123;</span><br><span class="line">        <span class="comment">// println!(&quot;&#123;&#125;&quot;, c);</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">count</span> = map.<span class="title function_ invoke__">entry</span>(c).<span class="title function_ invoke__">or_insert</span>(<span class="number">0</span>);</span><br><span class="line">        *count += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="使用-Vec-和-HashMap-实现一个简单的书籍库存管理系统"><a href="#使用-Vec-和-HashMap-实现一个简单的书籍库存管理系统" class="headerlink" title="使用 Vec 和 HashMap 实现一个简单的书籍库存管理系统"></a>使用 <code>Vec</code> 和 <code>HashMap</code> 实现一个简单的书籍库存管理系统</h5><p><code>todo</code></p>
<h3 id="返回值与错误处理"><a href="#返回值与错误处理" class="headerlink" title="返回值与错误处理"></a>返回值与错误处理</h3><h4 id="Option返回值"><a href="#Option返回值" class="headerlink" title="Option返回值"></a>Option返回值</h4><h5 id="解构Option"><a href="#解构Option" class="headerlink" title="解构Option"></a>解构Option</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Option</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="title function_ invoke__">Some</span>(T),</span><br><span class="line">    <span class="literal">None</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Option-辅助函数"><a href="#Option-辅助函数" class="headerlink" title="Option 辅助函数"></a>Option 辅助函数</h5><h6 id="unwarp"><a href="#unwarp" class="headerlink" title="unwarp"></a>unwarp</h6><p>如果我们确定 Option 中一定存在值，可以使用 <code>unwrap</code> 方法来获取该值。如果 Option 中不存在值，则会触发 panic。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">_test_3</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">rec</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">res</span> = rec.<span class="title function_ invoke__">pop</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="使用-is-some-和-is-none"><a href="#使用-is-some-和-is-none" class="headerlink" title="使用 is_some 和 is_none"></a>使用 is_some 和 is_none</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">rec</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">    <span class="comment">// let res = rec.pop().unwrap();</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">res</span> = rec.<span class="title function_ invoke__">get</span>(<span class="number">2</span>).<span class="title function_ invoke__">is_some</span>();</span><br><span class="line">    <span class="keyword">if</span> res &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, rec[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="使用-unwrap-or-提供默认值"><a href="#使用-unwrap-or-提供默认值" class="headerlink" title="使用 unwrap_or 提供默认值"></a>使用 unwrap_or 提供默认值</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">res</span> = <span class="title function_ invoke__">div</span>(<span class="number">3</span>, <span class="number">2</span>).<span class="title function_ invoke__">unwrap_or</span>(<span class="number">0.0</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;res: &#123;&#125;&quot;</span>, res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">div</span>(a: <span class="type">i32</span>, b: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;<span class="type">f64</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> b != <span class="number">0</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Some</span>(a <span class="keyword">as</span> <span class="type">f64</span> / b <span class="keyword">as</span> <span class="type">f64</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="literal">None</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Result-处理可恢复的错误"><a href="#Result-处理可恢复的错误" class="headerlink" title="Result 处理可恢复的错误"></a>Result 处理可恢复的错误</h4><h5 id="返回Result"><a href="#返回Result" class="headerlink" title="返回Result"></a>返回Result</h5><h6 id="例子一"><a href="#例子一" class="headerlink" title="例子一"></a>例子一</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">div_2</span>(<span class="number">3.0</span>, <span class="number">2.0</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(res) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;result is : &#123;&#125;&quot;</span>, res)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(e) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;err reason is: &#123;&#125;&quot;</span>, e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">div_2</span>(x: <span class="type">f64</span>, y: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>, <span class="type">String</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> y == <span class="number">0.0</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(<span class="string">&quot;y can not zero&quot;</span>.<span class="title function_ invoke__">to_string</span>())</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(x / y)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="例子二"><a href="#例子二" class="headerlink" title="例子二"></a>例子二</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">div</span>(<span class="number">3.0</span>, <span class="number">2.0</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(result) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;result: &#123;&#125;&quot;</span>, result)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(e) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;err reason: &#123;:?&#125;&quot;</span>, e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">sqrt</span>(<span class="number">4.0</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(result) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;result: &#123;&#125;&quot;</span>, result)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(e) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;err reason: &#123;:?&#125;&quot;</span>, e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">enum</span> <span class="title class_">MathError</span> &#123;</span><br><span class="line">    DivisionByZero,</span><br><span class="line">    NegativeSquareRoot,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">div</span>(x: <span class="type">f64</span>, y: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>, MathError&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> y == <span class="number">0.0</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(MathError::DivisionByZero)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(x / y)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">sqrt</span>(x: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>, MathError&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> x &lt; <span class="number">0.0</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(MathError::NegativeSquareRoot)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(x.<span class="title function_ invoke__">sqrt</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="对返回的错误进行处理"><a href="#对返回的错误进行处理" class="headerlink" title="对返回的错误进行处理"></a>对返回的错误进行处理</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">file</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;rust.tex&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">greeting_file</span> = <span class="keyword">match</span> file &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(file) =&gt; file,</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(error) =&gt; &#123;</span><br><span class="line">            <span class="comment">// panic!(&quot;err:&quot;);</span></span><br><span class="line">            <span class="keyword">match</span> error.<span class="title function_ invoke__">kind</span>() &#123;</span><br><span class="line">                ErrorKind::NotFound =&gt; <span class="keyword">match</span> File::<span class="title function_ invoke__">create</span>(<span class="string">&quot;rust.txt&quot;</span>) &#123;</span><br><span class="line">                    <span class="title function_ invoke__">Ok</span>(fc) =&gt; fc,</span><br><span class="line">                    <span class="title function_ invoke__">Err</span>(fe) =&gt; &#123;</span><br><span class="line">                        <span class="built_in">panic!</span>(<span class="string">&quot;Problem creating the file: &#123;fe:?&#125;&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                other_err =&gt; &#123;</span><br><span class="line">                    <span class="built_in">panic!</span>(<span class="string">&quot;Problem opening the file: &#123;other_err:?&#125;&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Result辅助方法"><a href="#Result辅助方法" class="headerlink" title="Result&lt;T,E&gt;辅助方法"></a>Result&lt;T,E&gt;辅助方法</h5><h6 id="unwarp-1"><a href="#unwarp-1" class="headerlink" title="unwarp"></a>unwarp</h6><ul>
<li>如果 <code>Result</code> 值是成员 <code>Ok</code>，<code>unwrap</code> 会返回 <code>Ok</code> 中的值。</li>
<li>如果 <code>Result</code> 是成员 <code>Err</code>，<code>unwrap</code> 会为我们调用 <code>panic!</code>。</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="comment">// 如果读取成功，返回文件，失败则会panic！</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">f</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;hello.txt&quot;</span>).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="expect"><a href="#expect" class="headerlink" title="expect"></a>expect</h6><p><code>expect</code> 跟 <code>unwrap</code> 很像，也是遇到错误直接 <code>panic</code>, 但是会带上自定义的错误提示信息，相当于重载了错误打印的函数</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">res</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;rust.text&quot;</span>).<span class="title function_ invoke__">expect</span>(<span class="string">&quot;file open err&quot;</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;res: &#123;:?&#125;&quot;</span>, res);</span><br></pre></td></tr></table></figure>

<h6 id="map"><a href="#map" class="headerlink" title="map"></a>map</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">line</span> = <span class="string">&quot;1\n2\n3\n4\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">num</span> <span class="keyword">in</span> line.<span class="title function_ invoke__">lines</span>() &#123;</span><br><span class="line">      <span class="comment">// map转化result中OK的值</span></span><br><span class="line">        <span class="keyword">match</span> num.parse::&lt;<span class="type">i32</span>&gt;().<span class="title function_ invoke__">map</span>(|i| i * <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">Ok</span>(x) =&gt; &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;x:&#123;&#125;&quot;</span>, x)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_ invoke__">Err</span>(_) =&gt; &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="map-err"><a href="#map-err" class="headerlink" title="map_err"></a>map_err</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    _result_3().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">_result_3</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;(), <span class="type">String</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// 程序的错误的返回类型已经定了是String，但是File::open的错误类型是std::io::Error</span></span><br><span class="line">    <span class="comment">// 通过map_err进行对错误类型的转换</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">result</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;rest.txt&quot;</span>).<span class="title function_ invoke__">map_err</span>(|e: std::io::Error| <span class="built_in">format!</span>(<span class="string">&quot;&#123;e&#125;&quot;</span>));</span><br><span class="line">    <span class="keyword">match</span> result &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(_) =&gt; <span class="title function_ invoke__">Ok</span>(()),</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(err) =&gt; <span class="title function_ invoke__">Err</span>(err),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="传播错误"><a href="#传播错误" class="headerlink" title="传播错误"></a>传播错误</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"><span class="keyword">use</span> std::io::&#123;<span class="keyword">self</span>, Read&#125;;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, io::Error&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">f</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;rust.txt&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">f</span> = <span class="keyword">match</span> f &#123;</span><br><span class="line">      <span class="comment">// 打开成功后，将成功的结果赋值给f</span></span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(result) =&gt; result,</span><br><span class="line">        <span class="comment">// 打开失败，将错误向上传播</span></span><br><span class="line">        <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="keyword">return</span> <span class="title function_ invoke__">Err</span>(e),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">match</span> f.<span class="title function_ invoke__">read_to_string</span>(&amp;<span class="keyword">mut</span> s) &#123;</span><br><span class="line">        <span class="comment">// 读取成功 返回Ok</span></span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(_) =&gt; <span class="title function_ invoke__">Ok</span>(s),</span><br><span class="line">        <span class="comment">// 读取错误，将错误向上传播</span></span><br><span class="line">        <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="title function_ invoke__">Err</span>(e),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="传播错误简写"><a href="#传播错误简写" class="headerlink" title="传播错误简写 ?"></a>传播错误简写 ?</h6><ul>
<li>如果结果是 <code>Ok(T)</code>，则把 <code>T</code> 赋值给 <code>f</code></li>
<li>如果结果是 <code>Err(E)</code>，则返回该错误</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"><span class="keyword">use</span> std::io;</span><br><span class="line"><span class="keyword">use</span> std::io::Read;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, io::Error&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">f</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;rust.txt&quot;</span>)?;</span><br><span class="line">    <span class="comment">// let mut f = match f &#123;</span></span><br><span class="line">    <span class="comment">//   // 打开成功后，将成功的结果赋值给f</span></span><br><span class="line">    <span class="comment">//     Ok(result) =&gt; result,</span></span><br><span class="line">    <span class="comment">//     // 打开失败，将错误向上传播</span></span><br><span class="line">    <span class="comment">//     Err(e) =&gt; return Err(e),</span></span><br><span class="line">    <span class="comment">// &#125;;</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="comment">// match f.read_to_string(&amp;mut s) &#123;</span></span><br><span class="line">    <span class="comment">//     // 读取成功 返回Ok</span></span><br><span class="line">    <span class="comment">//     Ok(_) =&gt; Ok(s),</span></span><br><span class="line">    <span class="comment">//     // 读取错误，将错误向上传播</span></span><br><span class="line">    <span class="comment">//     Err(e) =&gt; Err(e),</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s</span> = f.<span class="title function_ invoke__">read_to_string</span>(&amp;<span class="keyword">mut</span> s)?;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="链式调用"><a href="#链式调用" class="headerlink" title="链式调用"></a>链式调用</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">_result_4</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, io::Error&gt; &#123;</span><br><span class="line">    <span class="comment">// let mut f = File::open(&quot;rust.txt&quot;)?;</span></span><br><span class="line">    <span class="comment">// let mut f = match f &#123;</span></span><br><span class="line">    <span class="comment">//   // 打开成功后，将成功的结果赋值给f</span></span><br><span class="line">    <span class="comment">//     Ok(result) =&gt; result,</span></span><br><span class="line">    <span class="comment">//     // 打开失败，将错误向上传播</span></span><br><span class="line">    <span class="comment">//     Err(e) =&gt; return Err(e),</span></span><br><span class="line">    <span class="comment">// &#125;;</span></span><br><span class="line">    <span class="comment">// match f.read_to_string(&amp;mut s) &#123;</span></span><br><span class="line">    <span class="comment">//     // 读取成功 返回Ok</span></span><br><span class="line">    <span class="comment">//     Ok(_) =&gt; Ok(s),</span></span><br><span class="line">    <span class="comment">//     // 读取错误，将错误向上传播</span></span><br><span class="line">    <span class="comment">//     Err(e) =&gt; Err(e),</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="comment">// let s = f.read_to_string(&amp;mut s)?;</span></span><br><span class="line">    File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;rust.txt&quot;</span>)?.<span class="title function_ invoke__">read_to_string</span>(&amp;<span class="keyword">mut</span> s)?;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="链式调用结合map-err"><a href="#链式调用结合map-err" class="headerlink" title="链式调用结合map_err"></a>链式调用结合map_err</h6><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">_result_4</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, <span class="type">String</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// let mut f = File::open(&quot;rust.txt&quot;)?;</span></span><br><span class="line">    <span class="comment">// let mut f = match f &#123;</span></span><br><span class="line">    <span class="comment">//   // 打开成功后，将成功的结果赋值给f</span></span><br><span class="line">    <span class="comment">//     Ok(result) =&gt; result,</span></span><br><span class="line">    <span class="comment">//     // 打开失败，将错误向上传播</span></span><br><span class="line">    <span class="comment">//     Err(e) =&gt; return Err(e),</span></span><br><span class="line">    <span class="comment">// &#125;;</span></span><br><span class="line">    <span class="comment">// match f.read_to_string(&amp;mut s) &#123;</span></span><br><span class="line">    <span class="comment">//     // 读取成功 返回Ok</span></span><br><span class="line">    <span class="comment">//     Ok(_) =&gt; Ok(s),</span></span><br><span class="line">    <span class="comment">//     // 读取错误，将错误向上传播</span></span><br><span class="line">    <span class="comment">//     Err(e) =&gt; Err(e),</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="comment">// let s = f.read_to_string(&amp;mut s)?;</span></span><br><span class="line">    File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;rust.txt&quot;</span>)</span><br><span class="line">        .<span class="title function_ invoke__">map_err</span>(|e| <span class="built_in">format!</span>(<span class="string">&quot;&#123;e&#125;&quot;</span>))?</span><br><span class="line">        .<span class="title function_ invoke__">read_to_string</span>(&amp;<span class="keyword">mut</span> s)</span><br><span class="line">        .<span class="title function_ invoke__">map_err</span>(|e| <span class="built_in">format!</span>(<span class="string">&quot;&#123;e&#125;&quot;</span>))?;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="对于？的错误使用方式"><a href="#对于？的错误使用方式" class="headerlink" title="对于？的错误使用方式"></a>对于？的错误使用方式</h6><p><code>arr.get(0)?</code> 是不符合语法要求的，因为 <code>arr.get(0)</code> 返回的是一个 <code>Option&lt;&amp;i32&gt;</code>，而 <code>?</code> 运算符只能在返回类型为 <code>Result</code> 或 <code>Option</code> 的函数中进行解包。</p>
<p>具体来说，<code>arr.get(0)</code> 返回的是 <code>Option&lt;&amp;i32&gt;</code>，如果存在元素，它会返回 <code>Some(&amp;i32)</code>，否则返回 <code>None</code>。但是 <code>Option</code> 的 <code>?</code> 运算符只能在 <code>Option</code> 类型的返回值中用于解包，但在此情境下并没有必要。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">first</span>(arr: &amp;[<span class="type">i32</span>]) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;&amp;<span class="type">i32</span>&gt; &#123;</span><br><span class="line">   arr.<span class="title function_ invoke__">get</span>(<span class="number">0</span>)?</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Options-与Result的互相转换"><a href="#Options-与Result的互相转换" class="headerlink" title="Options 与Result的互相转换"></a>Options 与Result的互相转换</h4><h5 id="Options：ok-or"><a href="#Options：ok-or" class="headerlink" title="Options：ok_or"></a>Options：ok_or</h5><ul>
<li>Some(v)  -&gt; Ok(v)</li>
<li>None to Err(err)</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">arr</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">    <span class="keyword">match</span> _result_5(&amp;arr) &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(res) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;res: &#123;&#125;&quot;</span>, res);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(err) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;err: &#123;&#125;&quot;</span>, err);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">_result_5</span>(arr: &amp;[<span class="type">i32</span>]) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;&amp;<span class="type">i32</span>, <span class="type">String</span>&gt; &#123;</span><br><span class="line">    arr.<span class="title function_ invoke__">get</span>(<span class="number">100</span>).<span class="title function_ invoke__">ok_or</span>(<span class="string">&quot;out of index&quot;</span>.<span class="title function_ invoke__">to_string</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Result-err"><a href="#Result-err" class="headerlink" title="Result:err"></a>Result:err</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// err -&gt; some</span></span><br><span class="line">    <span class="comment">// ok -&gt; none</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">result</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;rust.txt&quot;</span>).<span class="title function_ invoke__">err</span>();</span><br><span class="line">    <span class="keyword">if</span> result.<span class="title function_ invoke__">is_some</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;文件读取失败&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Reust-ok"><a href="#Reust-ok" class="headerlink" title="Reust:ok"></a>Reust:ok</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// err -&gt; none</span></span><br><span class="line">    <span class="comment">// ok -&gt; some</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">result</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;rust.txt&quot;</span>).<span class="title function_ invoke__">ok</span>();</span><br><span class="line">    <span class="keyword">if</span> result.<span class="title function_ invoke__">is_none</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;文件读取失败&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="作业"><a href="#作业" class="headerlink" title="作业"></a>作业</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">_result_6</span>() &#123;</span><br><span class="line">    <span class="comment">// 修复call函数的错误</span></span><br><span class="line">    <span class="comment">// 当b为None时，按默认值1</span></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">call</span>(a: <span class="type">i32</span>, b: <span class="type">Option</span>&lt;<span class="type">i32</span>&gt;) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>, <span class="type">String</span>&gt; &#123;</span><br><span class="line">        <span class="comment">// 错误4 divide(a, b)返回的是一个optons，而sqrt(r)需要接受一个f64，通过ok_or转化</span></span><br><span class="line">        <span class="comment">// let r = divide(a, b);</span></span><br><span class="line">      	<span class="comment">// 优化1 将b使用Option包裹，使用unwrap_or传入默认值1</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">b</span> = b.<span class="title function_ invoke__">unwrap_or</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">r</span> = <span class="title function_ invoke__">divide</span>(a, b).<span class="title function_ invoke__">ok_or</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;b is zero&quot;</span>))?;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 错误2 sqrt(r)的Result错误类型是enum，而call函数定的是String，因此需要转换</span></span><br><span class="line">        <span class="comment">// 错误3 sqrt(r)返回的是Result，没有进行匹配处理，通过？语法将错误向上抛出</span></span><br><span class="line">        <span class="comment">// let s = sqrt(r);</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">s</span> = <span class="title function_ invoke__">sqrt</span>(r).<span class="title function_ invoke__">map_err</span>(|e| <span class="punctuation">-&gt;</span> <span class="type">String</span> &#123;</span><br><span class="line">            <span class="keyword">match</span> e &#123;</span><br><span class="line">                MathError::DivisionByZero =&gt; <span class="string">&quot;DivisionByZero&quot;</span>.<span class="title function_ invoke__">to_string</span>(),</span><br><span class="line">                MathError::NegativeSquareRoot =&gt; <span class="string">&quot;NegativeSquareRoot&quot;</span>.<span class="title function_ invoke__">to_string</span>(),</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)?;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 错误1,返回值如果没有return 不需要分号</span></span><br><span class="line">        <span class="comment">// Ok(s);</span></span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(s)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">divide</span>(a: <span class="type">i32</span>, b: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;<span class="type">f64</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> b != <span class="number">0</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">Some</span>(a <span class="keyword">as</span> <span class="type">f64</span> / b <span class="keyword">as</span> <span class="type">f64</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="literal">None</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">enum</span> <span class="title class_">MathError</span> &#123;</span><br><span class="line">        DivisionByZero,</span><br><span class="line">        NegativeSquareRoot,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">sqrt</span>(x: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>, MathError&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> x &lt; <span class="number">0.0</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">Err</span>(MathError::NegativeSquareRoot)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">Ok</span>(x.<span class="title function_ invoke__">sqrt</span>())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><h4 id="package"><a href="#package" class="headerlink" title="package"></a>package</h4><ul>
<li><p>packages包(cargo new packages_name)</p>
</li>
<li><p>cargo特性 让你构建、测试、共享crate</p>
</li>
<li><p>包含1个Cargo.toml，它描述了如何构建这些 Crates </p>
</li>
<li><p>只能包含0-1个library crate</p>
</li>
<li><p>可以包含任意数量的 binary crate</p>
</li>
<li><p>必须至少包含一个crate （library 或 binary）</p>
</li>
<li><p>一个package同时包含src&#x2F;main(binary create) src&#x2F;lib（library crate） 名称与package名相同</p>
</li>
</ul>
<h4 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h4><ul>
<li>visibility<ul>
<li>private(default)</li>
<li>pub(create)</li>
<li>pub(in path)</li>
<li>pub use</li>
</ul>
</li>
<li>mod 关键字</li>
<li>use 导包</li>
<li>as 重命名</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/lib.rs</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> a &#123;</span><br><span class="line">    <span class="keyword">const</span> number: <span class="type">i32</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">fn_a</span>() &#123;&#125;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">fn_a_1</span>() &#123;&#125;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">log</span>() &#123;&#125;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">mod</span> a_1 &#123;</span><br><span class="line">        <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">fn_a1_1</span>() &#123;</span><br><span class="line">            super::<span class="title function_ invoke__">fn_a_1</span>();</span><br><span class="line">            super::<span class="title function_ invoke__">fn_a</span>(); <span class="comment">// 私有的方法在模块内部是可以被调用的</span></span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;fn_a1_1 number : &#123;&#125;&quot;</span>, super::number);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">fn_a1_2</span>() &#123;</span><br><span class="line">          self::<span class="title function_ invoke__">fn_a1_1</span>();</span><br><span class="line">      &#125;</span><br><span class="line">        <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">log</span>() &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">mod</span> a_2 &#123;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">fn_a2_1</span>() &#123;&#125;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">fn_a2_2</span>() &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">fn_1</span>() &#123;</span><br><span class="line">    crate::a::a_1::<span class="title function_ invoke__">fn_a1_1</span>();</span><br><span class="line">    a::a_1::<span class="title function_ invoke__">fn_a1_2</span>();</span><br><span class="line">    a::<span class="title function_ invoke__">fn_a</span>();</span><br><span class="line">    a::<span class="title function_ invoke__">fn_a_1</span>(); <span class="comment">//私有方法在其他模块是无法被调用的  function `fn_a_1` is private</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/main.rs</span></span><br><span class="line"><span class="keyword">use</span> [package_name]::a::&#123;a_1::log <span class="keyword">as</span> log_2, log <span class="keyword">as</span> log_1&#125;;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    a_1::<span class="title function_ invoke__">fn_a1_1</span>();</span><br><span class="line">    <span class="title function_ invoke__">log_2</span>(); <span class="comment">// 使用as对相同方法进行重命名</span></span><br><span class="line">    <span class="title function_ invoke__">log_1</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="路径"><a href="#路径" class="headerlink" title="路径"></a>路径</h4><h5 id="相对路径"><a href="#相对路径" class="headerlink" title="相对路径"></a>相对路径</h5><ul>
<li><p>从当前模块开始，使用self、super或当前模块的标识符</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">super::<span class="title function_ invoke__">fn_a_1</span>(); <span class="comment">// 父模块</span></span><br><span class="line">self::<span class="title function_ invoke__">fn_a1_1</span>(); <span class="comment">// 自己</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="绝对路径"><a href="#绝对路径" class="headerlink" title="绝对路径"></a>绝对路径</h5><ul>
<li><p>从crate root开始</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crate::a::a_1::<span class="title function_ invoke__">fn_a1_1</span>(); <span class="comment">// crate表示当前模块的根</span></span><br><span class="line">[package_name]::a; <span class="comment">// 一个package同时包含src/main(binary create) src/lib（library crate）</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="workspace"><a href="#workspace" class="headerlink" title="workspace"></a>workspace</h4><h5 id="创建workspace"><a href="#创建workspace" class="headerlink" title="创建workspace"></a>创建workspace</h5><ul>
<li><p>创建工作区根目录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir my_workspace</span><br><span class="line">cd my_workspace</span><br></pre></td></tr></table></figure>
</li>
<li><p>手动创建 <code>Cargo.toml</code> 文件.在工作区的根目录中，手动创建 <code>Cargo.toml</code> 文件。你可以使用任何文本编辑器来创建这个文件。文件内容如下：</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[workspace]</span></span><br><span class="line"><span class="attr">members</span> = [</span><br><span class="line">    <span class="string">&quot;package_one&quot;</span>,</span><br><span class="line">    <span class="string">&quot;package_two&quot;</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建第一个包 <code>package_one</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo new package_on</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建第一个包 <code>package_two</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo new package_two</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查目录结构</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">my_workspace</span>/</span><br><span class="line">├── <span class="selector-tag">Cargo</span><span class="selector-class">.toml</span>    <span class="comment">// 手动创建的工作区配置文件</span></span><br><span class="line">├── <span class="selector-tag">package_one</span>/  <span class="comment">// 第一个包</span></span><br><span class="line">│   ├── <span class="selector-tag">Cargo</span><span class="selector-class">.toml</span></span><br><span class="line">│   └── <span class="selector-tag">src</span>/</span><br><span class="line">│       └── <span class="selector-tag">main</span><span class="selector-class">.rs</span></span><br><span class="line">└── <span class="selector-tag">package_two</span>/  <span class="comment">// 第二个包</span></span><br><span class="line">    ├── <span class="selector-tag">Cargo</span><span class="selector-class">.toml</span></span><br><span class="line">    └── <span class="selector-tag">src</span>/</span><br><span class="line">        └── <span class="selector-tag">main</span><span class="selector-class">.rs</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>构建工作区中的所有包：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo build</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行指定的包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo run --package package_one</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="workspace互相访问"><a href="#workspace互相访问" class="headerlink" title="workspace互相访问"></a>workspace互相访问</h5><ul>
<li><p>在 <code>package_one/src/lib.rs</code> 中添加一个模块</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> a &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">a_fn</span>() &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 <code>package_two</code> 中添加 <code>package_one</code> 作为依赖，打开 <code>package_two/Cargo.toml</code>，添加如下依赖：</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[package]</span><br><span class="line">name = <span class="string">&quot;package_two&quot;</span></span><br><span class="line">version = <span class="string">&quot;0.1.0&quot;</span></span><br><span class="line">edition = <span class="string">&quot;2021&quot;</span></span><br><span class="line"></span><br><span class="line">[dependencies]</span><br><span class="line">package_one = &#123; path = <span class="string">&quot;../package_one&quot;</span> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>在package_two中使用package_one模块方法</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> package_one::a;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">b_fn</span>() &#123;</span><br><span class="line">    a::<span class="title function_ invoke__">a_fn</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2025/01/03/Rust-L2%20Rust%E5%8F%98%E9%87%8F%E5%92%8C%E5%8F%AF%E5%8F%98%E6%80%A7/" rel="next" title="">
                <i class="fa fa-chevron-left"></i> 
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Rust-L3-Rust-%E5%9F%BA%E7%A1%80"><span class="nav-number">1.</span> <span class="nav-text">Rust-L3 Rust 基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E7%BB%84%E6%88%90"><span class="nav-number">1.1.</span> <span class="nav-text">函数组成</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="nav-number">1.1.1.</span> <span class="nav-text">基础概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A0"><span class="nav-number">1.1.2.</span> <span class="nav-text">练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="nav-number">1.2.</span> <span class="nav-text">流程控制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">基础概念</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E6%8E%A7%E5%88%B6"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">条件控制</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">循环</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%80%E6%9C%89%E6%9D%83%E8%BD%AC%E7%A7%BB"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">所有权转移</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A0%E9%A2%98"><span class="nav-number">1.2.2.</span> <span class="nav-text">练习题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.</span> <span class="nav-text">基础数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E6%A6%82%E8%A7%88"><span class="nav-number">1.3.1.</span> <span class="nav-text">类型概览</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B4%E5%9E%8B"><span class="nav-number">1.3.2.</span> <span class="nav-text">整型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%AE%E7%82%B9%E5%9E%8B"><span class="nav-number">1.3.3.</span> <span class="nav-text">浮点型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%83%E5%B0%94%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.4.</span> <span class="nav-text">布尔类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6"><span class="nav-number">1.3.5.</span> <span class="nav-text">字符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.3.6.</span> <span class="nav-text">强制类型转换</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%80%E6%9C%89%E6%9D%83"><span class="nav-number">1.4.</span> <span class="nav-text">所有权</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%80%E6%9C%89%E6%9D%83%E8%A7%84%E5%88%99"><span class="nav-number">1.4.1.</span> <span class="nav-text">所有权规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">1.4.2.</span> <span class="nav-text">变量的作用域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%80%E6%9C%89%E6%9D%83%E8%BD%AC%E7%A7%BB-1"><span class="nav-number">1.4.3.</span> <span class="nav-text">所有权转移</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A0%E9%A2%98-1"><span class="nav-number">1.4.4.</span> <span class="nav-text">练习题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E7%94%A8"><span class="nav-number">1.5.</span> <span class="nav-text">引用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E7%94%A8%E7%9A%84%E8%A7%84%E5%88%99"><span class="nav-number">1.5.1.</span> <span class="nav-text">引用的规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#move-borrowing-referencing"><span class="nav-number">1.5.2.</span> <span class="nav-text">move &amp; borrowing &amp; referencing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%87%E7%89%87"><span class="nav-number">1.5.3.</span> <span class="nav-text">切片</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BE%E5%90%8E%E4%B9%A0%E9%A2%98"><span class="nav-number">1.5.4.</span> <span class="nav-text">课后习题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E4%B8%8E%E5%88%87%E7%89%87"><span class="nav-number">1.6.</span> <span class="nav-text">数组与切片</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A3%B0%E6%98%8E%E5%92%8C%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E7%BB%84"><span class="nav-number">1.6.1.</span> <span class="nav-text">声明和初始化数组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%87%E7%89%87%E4%BE%8B%E5%AD%90"><span class="nav-number">1.6.2.</span> <span class="nav-text">切片例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A0%E9%A2%98-2"><span class="nav-number">1.6.3.</span> <span class="nav-text">练习题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.7.</span> <span class="nav-text">字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#str"><span class="nav-number">1.7.1.</span> <span class="nav-text">&amp;str</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#String"><span class="nav-number">1.7.2.</span> <span class="nav-text">String</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.7.3.</span> <span class="nav-text">操作字符串</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Enum-%E6%9E%9A%E4%B8%BE"><span class="nav-number">1.8.</span> <span class="nav-text">Enum 枚举</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95-%E8%A7%84%E8%8C%83"><span class="nav-number">1.8.1.</span> <span class="nav-text">语法&amp;规范</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Match"><span class="nav-number">1.8.2.</span> <span class="nav-text">Match</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Optons"><span class="nav-number">1.8.3.</span> <span class="nav-text">Optons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Result"><span class="nav-number">1.8.4.</span> <span class="nav-text">Result</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Options-Result%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.8.5.</span> <span class="nav-text">Options &amp; Result相互转换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#enum-mem"><span class="nav-number">1.8.6.</span> <span class="nav-text">enum mem</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#struct%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-number">1.9.</span> <span class="nav-text">struct结构体</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%99%AE%E9%80%9A%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-number">1.9.1.</span> <span class="nav-text">普通结构体</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-number">1.9.1.1.</span> <span class="nav-text">定义结构体</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%BB%93%E6%9E%84%E4%BD%93%E5%AE%9E%E4%BE%8B"><span class="nav-number">1.9.1.2.</span> <span class="nav-text">创建结构体实例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%AD%97%E6%AE%B5%E5%88%9D%E5%A7%8B%E5%8C%96%E7%AE%80%E5%8C%96%E8%AF%AD%E6%B3%95"><span class="nav-number">1.9.1.3.</span> <span class="nav-text">使用字段初始化简化语法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%8E%E5%85%B6%E4%BB%96%E5%AE%9E%E4%BE%8B%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BE%8B"><span class="nav-number">1.9.1.4.</span> <span class="nav-text">从其他实例创建实例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E7%BB%93%E6%9E%84%E4%BD%93%E5%AD%97%E6%AE%B5"><span class="nav-number">1.9.1.5.</span> <span class="nav-text">访问结构体字段</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E7%BB%93%E6%9E%84%E4%BD%93%E5%AD%97%E6%AE%B5%EF%BC%88%E5%8F%AF%E5%8F%98%E6%80%A7%EF%BC%89"><span class="nav-number">1.9.1.6.</span> <span class="nav-text">修改结构体字段（可变性）</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-number">1.9.2.</span> <span class="nav-text">特殊结构体</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%83%E7%BB%84%E7%BB%93%E6%9E%84%E4%BD%93%EF%BC%88Tuple-Struct%EF%BC%89"><span class="nav-number">1.9.2.1.</span> <span class="nav-text">元组结构体（Tuple Struct）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8D%95%E5%85%83%E7%BB%93%E6%9E%84%E4%BD%93-%EF%BC%88Unit-list-Struct%EF%BC%89"><span class="nav-number">1.9.2.2.</span> <span class="nav-text">单元结构体 （Unit-list Struct）</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%80%E6%9C%89%E6%9D%83-1"><span class="nav-number">1.9.3.</span> <span class="nav-text">所有权</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0copy%E7%89%B9%E6%80%A7%E7%9A%84%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%89%80%E6%9C%89%E6%9D%83%E8%BD%AC%E7%A7%BB"><span class="nav-number">1.9.3.1.</span> <span class="nav-text">实现copy特性的类型的所有权转移</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B2%A1%E6%9C%89%E5%AE%9E%E7%8E%B0copy%E7%89%B9%E6%80%A7%E7%9A%84%E6%89%80%E6%9C%89%E6%9D%83%E8%BD%AC%E7%A7%BB"><span class="nav-number">1.9.3.2.</span> <span class="nav-text">没有实现copy特性的所有权转移</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%9B%B4%E6%96%B0%E8%AF%AD%E6%B3%95"><span class="nav-number">1.9.3.3.</span> <span class="nav-text">结构体更新语法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%AD%E7%9A%84%E5%80%9F%E7%94%A8"><span class="nav-number">1.9.3.4.</span> <span class="nav-text">结构体中的借用</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95"><span class="nav-number">1.9.4.</span> <span class="nav-text">方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%96%B9%E6%B3%95"><span class="nav-number">1.9.4.1.</span> <span class="nav-text">定义方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#self%E3%80%81-self-mut-self"><span class="nav-number">1.9.4.2.</span> <span class="nav-text">self、&amp;self &amp;mut self</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E5%90%8D%E8%B7%9F%E7%BB%93%E6%9E%84%E4%BD%93%E5%AD%97%E6%AE%B5%E5%90%8D%E7%9B%B8%E5%90%8C"><span class="nav-number">1.9.4.3.</span> <span class="nav-text">方法名跟结构体字段名相同</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#getter-%E8%AE%BF%E9%97%AE%E5%99%A8"><span class="nav-number">1.9.4.4.</span> <span class="nav-text">getter 访问器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B3%E8%81%94%E5%87%BD%E6%95%B0"><span class="nav-number">1.9.4.5.</span> <span class="nav-text">关联函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%9A%E4%B8%AAimpl%E5%AE%9A%E4%B9%89"><span class="nav-number">1.9.4.6.</span> <span class="nav-text">多个impl定义</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0trail"><span class="nav-number">1.9.5.</span> <span class="nav-text">实现trail</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E4%B8%9A-%E5%AE%9E%E7%8E%B0Debug%E7%89%B9%E6%80%A7"><span class="nav-number">1.9.6.</span> <span class="nav-text">作业 实现Debug特性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.</span> <span class="nav-text">匹配模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.1.</span> <span class="nav-text">基础匹配模式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#match%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">1.10.1.1.</span> <span class="nav-text">match表达式</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%90%84%E7%A7%8D%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.2.</span> <span class="nav-text">匹配模式的各种模式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E9%9D%A2%E5%80%BC"><span class="nav-number">1.10.2.1.</span> <span class="nav-text">字面值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.2.2.</span> <span class="nav-text">变量模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.2.3.</span> <span class="nav-text">通配符模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%83%E7%BB%84%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.2.4.</span> <span class="nav-text">元组模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E4%BD%93%E5%AD%97%E6%AE%B5%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.2.5.</span> <span class="nav-text">结构体模式 + 结构体字段模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9E%9A%E4%B8%BE%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.2.6.</span> <span class="nav-text">枚举模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8C%83%E5%9B%B4%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.2.7.</span> <span class="nav-text">范围模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8C%89%E5%80%BC%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.2.8.</span> <span class="nav-text">按值匹配模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%A6%E5%AE%88%E5%8D%AB%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.2.9.</span> <span class="nav-text">带守卫模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%88%E5%B9%B6%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.2.10.</span> <span class="nav-text">合并模式</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F%E5%90%84%E7%A7%8D%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">1.10.3.</span> <span class="nav-text">匹配模式各种应用场景</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%84%E7%90%86%E9%94%99%E8%AF%AF"><span class="nav-number">1.10.3.1.</span> <span class="nav-text">处理错误</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%E6%8A%80%E5%B7%A7"><span class="nav-number">1.10.4.</span> <span class="nav-text">高级模式匹配技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B5%8C%E5%A5%97%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.4.1.</span> <span class="nav-text">嵌套模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F%E8%B7%9F%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="nav-number">1.10.4.2.</span> <span class="nav-text">匹配模式跟迭代器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#if-let%E5%92%8Cwhile-let-%E7%AE%80%E5%8C%96%E5%8D%95%E4%B8%AA%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.10.4.3.</span> <span class="nav-text">if let和while let 简化单个匹配模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ref-%E5%92%8Cref-mut"><span class="nav-number">1.10.4.4.</span> <span class="nav-text">ref 和ref mut</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0"><span class="nav-number">1.10.5.</span> <span class="nav-text">课后练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88"><span class="nav-number">1.11.</span> <span class="nav-text">常见集合</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Vec%EF%BC%88Vector%EF%BC%89"><span class="nav-number">1.11.1.</span> <span class="nav-text">Vec（Vector）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFVec"><span class="nav-number">1.11.1.1.</span> <span class="nav-text">什么是Vec</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Vec%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-number">1.11.1.2.</span> <span class="nav-text">Vec的基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">1.11.1.2.1.</span> <span class="nav-text">创建&#x2F;初始化</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%85%83%E7%B4%A0"><span class="nav-number">1.11.1.2.2.</span> <span class="nav-text">添加元素</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E5%85%83%E7%B4%A0"><span class="nav-number">1.11.1.2.3.</span> <span class="nav-text">访问元素</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%85%83%E7%B4%A0"><span class="nav-number">1.11.1.2.4.</span> <span class="nav-text">修改元素</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%81%8D%E5%8E%86"><span class="nav-number">1.11.1.2.5.</span> <span class="nav-text">遍历</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Vec%E8%BF%9B%E9%98%B6%E7%94%A8%E6%B3%95"><span class="nav-number">1.11.1.3.</span> <span class="nav-text">Vec进阶用法</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%9E%9A%E4%B8%BE%E5%AD%98%E5%82%A8%E5%A4%9A%E7%A7%8D%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.11.1.3.1.</span> <span class="nav-text">使用枚举存储多种类型</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AE%B9%E9%87%8F%E4%B8%8E%E9%87%8D%E6%96%B0%E5%88%86%E9%85%8D"><span class="nav-number">1.11.1.3.2.</span> <span class="nav-text">容量与重新分配</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Vec%E5%B8%B8%E8%A7%81%E7%9A%84%E9%99%B7%E9%98%B1"><span class="nav-number">1.11.1.4.</span> <span class="nav-text">Vec常见的陷阱</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E8%B6%8A%E7%95%8C"><span class="nav-number">1.11.1.4.1.</span> <span class="nav-text">索引越界</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8F%AF%E5%8F%98%E5%BC%95%E7%94%A8%E4%B8%8E%E4%B8%8D%E5%8F%AF%E5%8F%98%E5%BC%95%E7%94%A8%E7%9A%84%E6%B7%B7%E7%94%A8"><span class="nav-number">1.11.1.4.2.</span> <span class="nav-text">可变引用与不可变引用的混用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HashMap"><span class="nav-number">1.11.2.</span> <span class="nav-text">HashMap</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#HashMap%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-number">1.11.2.1.</span> <span class="nav-text">HashMap基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">1.11.2.1.1.</span> <span class="nav-text">创建和初始化</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E5%85%83%E7%B4%A0-1"><span class="nav-number">1.11.2.1.2.</span> <span class="nav-text">访问元素</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E5%85%83%E7%B4%A0"><span class="nav-number">1.11.2.1.3.</span> <span class="nav-text">遍历元素</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HashMap-%E8%BF%9B%E9%98%B6%E7%94%A8%E6%B3%95"><span class="nav-number">1.11.2.2.</span> <span class="nav-text">HashMap 进阶用法</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E5%93%88%E5%B8%8C%E8%A1%A8"><span class="nav-number">1.11.2.2.1.</span> <span class="nav-text">更新哈希表</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%90%88%E5%B9%B6%E5%93%88%E5%B8%8C%E8%A1%A8"><span class="nav-number">1.11.2.2.2.</span> <span class="nav-text">合并哈希表</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HashMap-%E5%B8%B8%E8%A7%81%E9%99%B7%E9%98%B1"><span class="nav-number">1.11.2.3.</span> <span class="nav-text">HashMap 常见陷阱</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%93%88%E5%B8%8C%E5%86%B2%E7%AA%81"><span class="nav-number">1.11.2.3.1.</span> <span class="nav-text">哈希冲突</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%80%BC%E7%9A%84%E6%89%80%E6%9C%89%E6%9D%83%E9%97%AE%E9%A2%98"><span class="nav-number">1.11.2.3.2.</span> <span class="nav-text">值的所有权问题</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A0-1"><span class="nav-number">1.11.3.</span> <span class="nav-text">练习</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8vec%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84%E6%A0%88"><span class="nav-number">1.11.3.1.</span> <span class="nav-text">使用vec实现简单的栈</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%94%A8-HashMap-%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%AD%97%E9%A2%91%E7%BB%9F%E8%AE%A1%E5%99%A8"><span class="nav-number">1.11.3.2.</span> <span class="nav-text">用 HashMap 实现一个字频统计器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-Vec-%E5%92%8C-HashMap-%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E4%B9%A6%E7%B1%8D%E5%BA%93%E5%AD%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="nav-number">1.11.3.3.</span> <span class="nav-text">使用 Vec 和 HashMap 实现一个简单的书籍库存管理系统</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC%E4%B8%8E%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="nav-number">1.12.</span> <span class="nav-text">返回值与错误处理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Option%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-number">1.12.1.</span> <span class="nav-text">Option返回值</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E6%9E%84Option"><span class="nav-number">1.12.1.1.</span> <span class="nav-text">解构Option</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Option-%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0"><span class="nav-number">1.12.1.2.</span> <span class="nav-text">Option 辅助函数</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#unwarp"><span class="nav-number">1.12.1.2.1.</span> <span class="nav-text">unwarp</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-is-some-%E5%92%8C-is-none"><span class="nav-number">1.12.1.2.2.</span> <span class="nav-text">使用 is_some 和 is_none</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-unwrap-or-%E6%8F%90%E4%BE%9B%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="nav-number">1.12.1.2.3.</span> <span class="nav-text">使用 unwrap_or 提供默认值</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Result-%E5%A4%84%E7%90%86%E5%8F%AF%E6%81%A2%E5%A4%8D%E7%9A%84%E9%94%99%E8%AF%AF"><span class="nav-number">1.12.2.</span> <span class="nav-text">Result 处理可恢复的错误</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%94%E5%9B%9EResult"><span class="nav-number">1.12.2.1.</span> <span class="nav-text">返回Result</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%E4%B8%80"><span class="nav-number">1.12.2.1.1.</span> <span class="nav-text">例子一</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%E4%BA%8C"><span class="nav-number">1.12.2.1.2.</span> <span class="nav-text">例子二</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AF%B9%E8%BF%94%E5%9B%9E%E7%9A%84%E9%94%99%E8%AF%AF%E8%BF%9B%E8%A1%8C%E5%A4%84%E7%90%86"><span class="nav-number">1.12.2.2.</span> <span class="nav-text">对返回的错误进行处理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Result%E8%BE%85%E5%8A%A9%E6%96%B9%E6%B3%95"><span class="nav-number">1.12.2.3.</span> <span class="nav-text">Result&lt;T,E&gt;辅助方法</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#unwarp-1"><span class="nav-number">1.12.2.3.1.</span> <span class="nav-text">unwarp</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#expect"><span class="nav-number">1.12.2.3.2.</span> <span class="nav-text">expect</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#map"><span class="nav-number">1.12.2.3.3.</span> <span class="nav-text">map</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#map-err"><span class="nav-number">1.12.2.3.4.</span> <span class="nav-text">map_err</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%A0%E6%92%AD%E9%94%99%E8%AF%AF"><span class="nav-number">1.12.3.</span> <span class="nav-text">传播错误</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BC%A0%E6%92%AD%E9%94%99%E8%AF%AF%E7%AE%80%E5%86%99"><span class="nav-number">1.12.3.0.1.</span> <span class="nav-text">传播错误简写 ?</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8"><span class="nav-number">1.12.3.0.2.</span> <span class="nav-text">链式调用</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8%E7%BB%93%E5%90%88map-err"><span class="nav-number">1.12.3.0.3.</span> <span class="nav-text">链式调用结合map_err</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AF%B9%E4%BA%8E%EF%BC%9F%E7%9A%84%E9%94%99%E8%AF%AF%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="nav-number">1.12.3.0.4.</span> <span class="nav-text">对于？的错误使用方式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Options-%E4%B8%8EResult%E7%9A%84%E4%BA%92%E7%9B%B8%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.12.4.</span> <span class="nav-text">Options 与Result的互相转换</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Options%EF%BC%9Aok-or"><span class="nav-number">1.12.4.1.</span> <span class="nav-text">Options：ok_or</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Result-err"><span class="nav-number">1.12.4.2.</span> <span class="nav-text">Result:err</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Reust-ok"><span class="nav-number">1.12.4.3.</span> <span class="nav-text">Reust:ok</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E4%B8%9A"><span class="nav-number">1.12.5.</span> <span class="nav-text">作业</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="nav-number">1.13.</span> <span class="nav-text">模块化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#package"><span class="nav-number">1.13.1.</span> <span class="nav-text">package</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Modules"><span class="nav-number">1.13.2.</span> <span class="nav-text">Modules</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E5%BE%84"><span class="nav-number">1.13.3.</span> <span class="nav-text">路径</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84"><span class="nav-number">1.13.3.1.</span> <span class="nav-text">相对路径</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84"><span class="nav-number">1.13.3.2.</span> <span class="nav-text">绝对路径</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#workspace"><span class="nav-number">1.13.4.</span> <span class="nav-text">workspace</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAworkspace"><span class="nav-number">1.13.4.1.</span> <span class="nav-text">创建workspace</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#workspace%E4%BA%92%E7%9B%B8%E8%AE%BF%E9%97%AE"><span class="nav-number">1.13.4.2.</span> <span class="nav-text">workspace互相访问</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
